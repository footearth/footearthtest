<html lang="en">
<head>
<title>String Conversion Precision - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Floating-Point-Issues.html#Floating-Point-Issues" title="Floating Point Issues">
<link rel="next" href="Unexpected-Results.html#Unexpected-Results" title="Unexpected Results">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="String-Conversion-Precision"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Unexpected-Results.html#Unexpected-Results">Unexpected Results</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Floating-Point-Issues.html#Floating-Point-Issues">Floating Point Issues</a>
<hr>
</div>

<h4 class="appendixsubsec">D.3.1 The String Value Can Lie</h4>

<p>Internally, <samp><span class="command">awk</span></samp> keeps both the numeric value
(double-precision floating-point) and the string value for a variable. 
Separately, <samp><span class="command">awk</span></samp> keeps
track of what type the variable has
(see <a href="Typing-and-Comparison.html#Typing-and-Comparison">Typing and Comparison</a>),
which plays a role in how variables are used in comparisons.

   <p>It is important to note that the string value for a number may not
reflect the full value (all the digits) that the numeric value
actually contains. 
The following program (<samp><span class="file">values.awk</span></samp>) illustrates this:

<pre class="example">     {
        $1 = $2 + $3
        # see it for what it is
        printf("$1 = %.12g\n", $1)
        # use CONVFMT
        a = "&lt;" $1 "&gt;"
        print "a =", a
        # use OFMT
        print "$1 =", $1
     }
</pre>
   <p class="noindent">This program shows the full value of the sum of <code>$2</code> and <code>$3</code>
using <code>printf</code>, and then prints the string values obtained
from both automatic conversion (via <code>CONVFMT</code>) and
from printing (via <code>OFMT</code>).

   <p>Here is what happens when the program is run:

<pre class="example">     $ echo 2 3.654321 1.2345678 | awk -f values.awk
     -| $1 = 4.8888888
     -| a = &lt;4.88889&gt;
     -| $1 = 4.88889
</pre>
   <p>This makes it clear that the full numeric value is different from
what the default string representations show.

   <p><code>CONVFMT</code>'s default value is <code>"%.6g"</code>, which yields a value with
at least six significant digits.  For some applications, you might want to
change it to specify more precision. 
On most modern machines, most of the time,
17 digits is enough to capture a floating-point number's
value exactly.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> Pathological cases can require up to
752 digits (!), but we doubt that you need to worry about this.</p>

   <hr></div>

   </body></html>

