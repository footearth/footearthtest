<html lang="en">
<head>
<title>Gettimeofday Function - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="General-Functions.html#General-Functions" title="General Functions">
<link rel="prev" href="Join-Function.html#Join-Function" title="Join Function">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Gettimeofday-Function"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Join-Function.html#Join-Function">Join Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="General-Functions.html#General-Functions">General Functions</a>
<hr>
</div>

<h4 class="subsection">12.2.8 Managing the Time of Day</h4>

<p><a name="index-libraries-of-_0040command_007bawk_007d-functions_002c-managing_002c-time-1672"></a><a name="index-functions_002c-library_002c-managing-time-1673"></a><a name="index-timestamps_002c-formatted-1674"></a><a name="index-time_002c-managing-1675"></a>The <code>systime</code> and <code>strftime</code> functions described in
<a href="Time-Functions.html#Time-Functions">Time Functions</a>,
provide the minimum functionality necessary for dealing with the time of day
in human readable form.  While <code>strftime</code> is extensive, the control
formats are not necessarily easy to remember or intuitively obvious when
reading a program.

   <p>The following function, <code>gettimeofday</code>, populates a user-supplied array
with preformatted time information.  It returns a string with the current
time formatted in the same way as the <samp><span class="command">date</span></samp> utility:

   <p><a name="index-g_t_0040code_007bgettimeofday_007d-user_002ddefined-function-1676"></a>
<pre class="example">     <!-- file eg/lib/gettime.awk -->
     # gettimeofday.awk --- get the time of day in a usable format
     <!-- endfile -->
     <!-- file eg/lib/gettime.awk -->
     
     # Returns a string in the format of output of date(1)
     # Populates the array argument time with individual values:
     #    time["second"]       -- seconds (0 - 59)
     #    time["minute"]       -- minutes (0 - 59)
     #    time["hour"]         -- hours (0 - 23)
     #    time["althour"]      -- hours (0 - 12)
     #    time["monthday"]     -- day of month (1 - 31)
     #    time["month"]        -- month of year (1 - 12)
     #    time["monthname"]    -- name of the month
     #    time["shortmonth"]   -- short name of the month
     #    time["year"]         -- year modulo 100 (0 - 99)
     #    time["fullyear"]     -- full year
     #    time["weekday"]      -- day of week (Sunday = 0)
     #    time["altweekday"]   -- day of week (Monday = 0)
     #    time["dayname"]      -- name of weekday
     #    time["shortdayname"] -- short name of weekday
     #    time["yearday"]      -- day of year (0 - 365)
     #    time["timezone"]     -- abbreviation of timezone name
     #    time["ampm"]         -- AM or PM designation
     #    time["weeknum"]      -- week number, Sunday first day
     #    time["altweeknum"]   -- week number, Monday first day
     
     function gettimeofday(time,    ret, now, i)
     {
         # get time once, avoids unnecessary system calls
         now = systime()
     
         # return date(1)-style output
         ret = strftime("%a %b %d %H:%M:%S %Z %Y", now)
     
         # clear out target array
         delete time
     
         # fill in values, force numeric values to be
         # numeric by adding 0
         time["second"]       = strftime("%S", now) + 0
         time["minute"]       = strftime("%M", now) + 0
         time["hour"]         = strftime("%H", now) + 0
         time["althour"]      = strftime("%I", now) + 0
         time["monthday"]     = strftime("%d", now) + 0
         time["month"]        = strftime("%m", now) + 0
         time["monthname"]    = strftime("%B", now)
         time["shortmonth"]   = strftime("%b", now)
         time["year"]         = strftime("%y", now) + 0
         time["fullyear"]     = strftime("%Y", now) + 0
         time["weekday"]      = strftime("%w", now) + 0
         time["altweekday"]   = strftime("%u", now) + 0
         time["dayname"]      = strftime("%A", now)
         time["shortdayname"] = strftime("%a", now)
         time["yearday"]      = strftime("%j", now) + 0
         time["timezone"]     = strftime("%Z", now)
         time["ampm"]         = strftime("%p", now)
         time["weeknum"]      = strftime("%U", now) + 0
         time["altweeknum"]   = strftime("%W", now) + 0
     
         return ret
     }
     <!-- endfile -->
</pre>
   <p>The string indices are easier to use and read than the various formats
required by <code>strftime</code>.  The <code>alarm</code> program presented in
<a href="Alarm-Program.html#Alarm-Program">Alarm Program</a>,
uses this function. 
A more general design for the <code>gettimeofday</code> function would have
allowed the user to supply an optional timestamp value to use instead
of the current time.

   </body></html>

