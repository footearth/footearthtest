<html lang="en">
<head>
<title>Adding Code - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Additions.html#Additions" title="Additions">
<link rel="next" href="New-Ports.html#New-Ports" title="New Ports">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Adding-Code"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="New-Ports.html#New-Ports">New Ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Additions.html#Additions">Additions</a>
<hr>
</div>

<h4 class="appendixsubsec">C.2.1 Adding New Features</h4>

<!-- STARTOFRANGE adfgaw -->
<p><a name="index-adding_002c-features-to-_0040command_007bgawk_007d-1975"></a><!-- STARTOFRANGE fadgaw -->
<a name="index-features_002c-adding-to-_0040command_007bgawk_007d-1976"></a><!-- STARTOFRANGE gawadf -->
<a name="index-g_t_0040command_007bgawk_007d_002c-features_002c-adding-1977"></a>You are free to add any new features you like to <samp><span class="command">gawk</span></samp>. 
However, if you want your changes to be incorporated into the <samp><span class="command">gawk</span></samp>
distribution, there are several steps that you need to take in order to
make it possible for me to include your changes:

     <ol type=1 start=1>
<li>Before building the new feature into <samp><span class="command">gawk</span></samp> itself,
consider writing it as an extension module
(see <a href="Dynamic-Extensions.html#Dynamic-Extensions">Dynamic Extensions</a>). 
If that's not possible, continue with the rest of the steps in this list.

     <li>Get the latest version. 
It is much easier for me to integrate changes if they are relative to
the most recent distributed version of <samp><span class="command">gawk</span></samp>.  If your version of
<samp><span class="command">gawk</span></samp> is very old, I may not be able to integrate them at all. 
(See <a href="Getting.html#Getting">Getting</a>,
for information on getting the latest version of <samp><span class="command">gawk</span></samp>.)

     <li>Follow the <cite>GNU Coding Standards</cite>. 
This document describes how GNU software should be written. If you haven't
read it, please do so, preferably <em>before</em> starting to modify <samp><span class="command">gawk</span></samp>. 
(The <cite>GNU Coding Standards</cite> are available from
the GNU Project's
<samp><span class="command">ftp</span></samp>
site, at
<a href="ftp://ftp.gnu.org/gnu/GNUinfo/standards.text">ftp://ftp.gnu.org/gnu/GNUinfo/standards.text</a>. 
An HTML version, suitable for reading with a WWW browser, is
available at
<a href="http://www.gnu.org/prep/standards_toc.html">http://www.gnu.org/prep/standards_toc.html</a>. 
Texinfo, Info, and DVI versions are also available.)

     <p><a name="index-g_t_0040command_007bgawk_007d_002c-coding-style-in-1978"></a><li>Use the <samp><span class="command">gawk</span></samp> coding style. 
The C code for <samp><span class="command">gawk</span></samp> follows the instructions in the
<cite>GNU Coding Standards</cite>, with minor exceptions.  The code is formatted
using the traditional &ldquo;K&amp;R&rdquo; style, particularly as regards to the placement
of braces and the use of TABs.  In brief, the coding rules for <samp><span class="command">gawk</span></samp>
are as follows:

          <ul>
<li>Use ANSI/ISO style (prototype) function headers when defining functions.

          <li>Put the name of the function at the beginning of its own line.

          <li>Put the return type of the function, even if it is <code>int</code>, on the
line above the line with the name and arguments of the function.

          <li>Put spaces around parentheses used in control structures
(<code>if</code>, <code>while</code>, <code>for</code>, <code>do</code>, <code>switch</code>,
and <code>return</code>).

          <li>Do not put spaces in front of parentheses used in function calls.

          <li>Put spaces around all C operators and after commas in function calls.

          <li>Do not use the comma operator to produce multiple side effects, except
in <code>for</code> loop initialization and increment parts, and in macro bodies.

          <li>Use real TABs for indenting, not spaces.

          <li>Use the &ldquo;K&amp;R&rdquo; brace layout style.

          <li>Use comparisons against <code>NULL</code> and <code>'\0'</code> in the conditions of
<code>if</code>, <code>while</code>, and <code>for</code> statements, as well as in the <code>case</code>s
of <code>switch</code> statements, instead of just the
plain pointer or character value.

          <li>Use the <code>TRUE</code>, <code>FALSE</code> and <code>NULL</code> symbolic constants
and the character constant <code>'\0'</code> where appropriate, instead of <code>1</code>
and <code>0</code>.

          <li>Use the <code>ISALPHA</code>, <code>ISDIGIT</code>, etc. macros, instead of the
traditional lowercase versions; these macros are better behaved for
non-ASCII character sets.

          <li>Provide one-line descriptive comments for each function.

          <li>Do not use &lsquo;<samp><span class="samp">#elif</span></samp>&rsquo;. Many older Unix C compilers cannot handle it.

          <li>Do not use the <code>alloca</code> function for allocating memory off the stack. 
Its use causes more portability trouble than is worth the minor benefit of not having
to free the storage. Instead, use <code>malloc</code> and <code>free</code>. 
</ul>

     <blockquote>
<b>NOTE:</b> If I have to reformat your code to follow the coding style used in
<samp><span class="command">gawk</span></samp>, I may not bother to integrate your changes at all. 
</blockquote>

     <li>Be prepared to sign the appropriate paperwork. 
In order for the FSF to distribute your changes, you must either place
those changes in the public domain and submit a signed statement to that
effect, or assign the copyright in your changes to the FSF. 
Both of these actions are easy to do and <em>many</em> people have done so
already. If you have questions, please contact me
(see <a href="Bugs.html#Bugs">Bugs</a>),
or <a href="mailto:gnu@gnu.org">gnu@gnu.org</a>.

     <p><a name="index-Texinfo-1979"></a><li>Update the documentation. 
Along with your new code, please supply new sections and/or chapters
for this Web page.  If at all possible, please use real
Texinfo, instead of just supplying unformatted ASCII text (although
even that is better than no documentation at all). 
Conventions to be followed in <cite>GAWK: Effective AWK Programming</cite> are provided
after the &lsquo;<samp><span class="samp">@bye</span></samp>&rsquo; at the end of the Texinfo source file. 
If possible, please update the <samp><span class="command">man</span></samp> page as well.

     <p>You will also have to sign paperwork for your documentation changes.

     <li>Submit changes as context diffs or unified diffs. 
Use &lsquo;<samp><span class="samp">diff -c -r -N</span></samp>&rsquo; or &lsquo;<samp><span class="samp">diff -u -r -N</span></samp>&rsquo; to compare
the original <samp><span class="command">gawk</span></samp> source tree with your version. 
(I find context diffs to be more readable but unified diffs are
more compact.) 
I recommend using the GNU version of <samp><span class="command">diff</span></samp>. 
Send the output produced by either run of <samp><span class="command">diff</span></samp> to me when you
submit your changes. 
(See <a href="Bugs.html#Bugs">Bugs</a>, for the electronic mail
information.)

     <p>Using this format makes it easy for me to apply your changes to the
master version of the <samp><span class="command">gawk</span></samp> source code (using <code>patch</code>). 
If I have to apply the changes manually, using a text editor, I may
not do so, particularly if there are lots of changes.

     <li>Include an entry for the <samp><span class="file">ChangeLog</span></samp> file with your submission. 
This helps further minimize the amount of work I have to do,
making it easier for me to accept patches.
        </ol>

   <p>Although this sounds like a lot of work, please remember that while you
may write the new code, I have to maintain it and support it. If it
isn't possible for me to do that with a minimum of extra work, then I
probably will not. 
<!-- ENDOFRANGE adfgaw -->
<!-- ENDOFRANGE gawadf -->
<!-- ENDOFRANGE fadgaw -->

   </body></html>

