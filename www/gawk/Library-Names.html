<html lang="en">
<head>
<title>Library Names - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Library-Functions.html#Library-Functions" title="Library Functions">
<link rel="next" href="General-Functions.html#General-Functions" title="General Functions">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Library-Names"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="General-Functions.html#General-Functions">General Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Library-Functions.html#Library-Functions">Library Functions</a>
<hr>
</div>

<h3 class="section">12.1 Naming Library Function Global Variables</h3>

<p><a name="index-names_002c-arrays_002fvariables-1611"></a><a name="index-names_002c-functions-1612"></a><a name="index-namespace-issues-1613"></a><a name="index-g_t_0040command_007bawk_007d-programs_002c-documenting-1614"></a><a name="index-documentation_002c-of-_0040command_007bawk_007d-programs-1615"></a>Due to the way the <samp><span class="command">awk</span></samp> language evolved, variables are either
<dfn>global</dfn> (usable by the entire program) or <dfn>local</dfn> (usable just by
a specific function).  There is no intermediate state analogous to
<code>static</code> variables in C.

   <p><a name="index-variables_002c-global_002c-for-library-functions-1616"></a><a name="index-private-variables-1617"></a><a name="index-variables_002c-private-1618"></a>Library functions often need to have global variables that they can use to
preserve state information between calls to the function&mdash;for example,
<code>getopt</code>'s variable <code>_opti</code>
(see <a href="Getopt-Function.html#Getopt-Function">Getopt Function</a>). 
Such variables are called <dfn>private</dfn>, since the only functions that need to
use them are the ones in the library.

   <p>When writing a library function, you should try to choose names for your
private variables that will not conflict with any variables used by
either another library function or a user's main program.  For example, a
name like &lsquo;<samp><span class="samp">i</span></samp>&rsquo; or &lsquo;<samp><span class="samp">j</span></samp>&rsquo; is not a good choice, because user programs
often use variable names like these for their own purposes.

   <p><a name="index-programming-conventions_002c-private-variable-names-1619"></a>The example programs shown in this chapter all start the names of their
private variables with an underscore (&lsquo;<samp><span class="samp">_</span></samp>&rsquo;).  Users generally don't use
leading underscores in their variable names, so this convention immediately
decreases the chances that the variable name will be accidentally shared
with the user's program.

   <p><a name="index-g_t_0040code_007b_005f_007d-_0028underscore_0029_002c-in-names-of-private-variables-1620"></a><a name="index-underscore-_0028_0040code_007b_005f_007d_0029_002c-in-names-of-private-variables-1621"></a>In addition, several of the library functions use a prefix that helps
indicate what function or set of functions use the variables&mdash;for example,
<code>_pw_byname</code> in the user database routines
(see <a href="Passwd-Functions.html#Passwd-Functions">Passwd Functions</a>). 
This convention is recommended, since it even further decreases the
chance of inadvertent conflict among variable names.  Note that this
convention is used equally well for variable names and for private
function names as well.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

   <p>As a final note on variable naming, if a function makes global variables
available for use by a main program, it is a good convention to start that
variable's name with a capital letter&mdash;for
example, <code>getopt</code>'s <code>Opterr</code> and <code>Optind</code> variables
(see <a href="Getopt-Function.html#Getopt-Function">Getopt Function</a>). 
The leading capital letter indicates that it is global, while the fact that
the variable name is not all capital letters indicates that the variable is
not one of <samp><span class="command">awk</span></samp>'s built-in variables, such as <code>FS</code>.

   <p><a name="index-g_t_0040code_007b_002d_002ddump_002dvariables_007d-option-1622"></a>It is also important that <em>all</em> variables in library
functions that do not need to save state are, in fact, declared
local.<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a> If this is not done, the variable
could accidentally be used in the user's program, leading to bugs that
are very difficult to track down:

<pre class="example">     function lib_func(x, y,    l1, l2)
     {
         ...
         <var>use variable</var> some_var   # some_var should be local
         ...                   # but is not by oversight
     }
</pre>
   <p><a name="index-arrays_002c-associative_002c-library-functions-and-1623"></a><a name="index-libraries-of-_0040command_007bawk_007d-functions_002c-associative-arrays-and-1624"></a><a name="index-functions_002c-library_002c-associative-arrays-and-1625"></a><a name="index-Tcl-1626"></a>A different convention, common in the Tcl community, is to use a single
associative array to hold the values needed by the library function(s), or
&ldquo;package.&rdquo;  This significantly decreases the number of actual global names
in use.  For example, the functions described in
<a href="Passwd-Functions.html#Passwd-Functions">Passwd Functions</a>,
might have used array elements <code>PW_data["inited"]<!-- /@w --></code>, <code>PW_data["total"]<!-- /@w --></code>,
<code>PW_data["count"]<!-- /@w --></code>, and <code>PW_data["awklib"]<!-- /@w --></code>, instead of
<code>_pw_inited<!-- /@w --></code>, <code>_pw_awklib<!-- /@w --></code>, <code>_pw_total<!-- /@w --></code>,
and <code>_pw_count<!-- /@w --></code>.

   <p>The conventions presented in this section are exactly
that: conventions. You are not required to write your programs this
way&mdash;we merely recommend that you do so.

   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> While all the library routines could have
been rewritten to use this convention, this was not done, in order to
show how my own <samp><span class="command">awk</span></samp> programming style has evolved and to
provide some basis for this discussion.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> <samp><span class="command">gawk</span></samp>'s <samp><span class="option">--dump-variables</span></samp> command-line
option is useful for verifying this.</p>

   <hr></div>

   </body></html>

