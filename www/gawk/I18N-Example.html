<html lang="en">
<head>
<title>I18N Example - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Internationalization.html#Internationalization" title="Internationalization">
<link rel="prev" href="Translator-i18n.html#Translator-i18n" title="Translator i18n">
<link rel="next" href="Gawk-I18N.html#Gawk-I18N" title="Gawk I18N">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="I18N-Example"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Gawk-I18N.html#Gawk-I18N">Gawk I18N</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Translator-i18n.html#Translator-i18n">Translator i18n</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Internationalization.html#Internationalization">Internationalization</a>
<hr>
</div>

<h3 class="section">9.5 A Simple Internationalization Example</h3>

<p>Now let's look at a step-by-step example of how to internationalize and
localize a simple <samp><span class="command">awk</span></samp> program, using <samp><span class="file">guide.awk</span></samp> as our
original source:

<pre class="example">     <!-- file eg/prog/guide.awk -->
     BEGIN {
         TEXTDOMAIN = "guide"
         bindtextdomain(".")  # for testing
         print _"Don't Panic"
         print _"The Answer Is", 42
         print "Pardon me, Zaphod who?"
     }
     <!-- endfile -->
</pre>
   <p class="noindent">Run &lsquo;<samp><span class="samp">gawk --gen-po</span></samp>&rsquo; to create the <samp><span class="file">.po</span></samp> file:

<pre class="example">     $ gawk --gen-po -f guide.awk &gt; guide.po
</pre>
   <p class="noindent">This produces:

<pre class="example">     <!-- file eg/data/guide.po -->
     #: guide.awk:4
     msgid "Don't Panic"
     msgstr ""
     
     #: guide.awk:5
     msgid "The Answer Is"
     msgstr ""
     
     <!-- endfile -->
</pre>
   <p>This original portable object file is saved and reused for each language
into which the application is translated.  The <code>msgid</code>
is the original string and the <code>msgstr</code> is the translation.

   <blockquote>
<b>NOTE:</b> Strings not marked with a leading underscore do not
appear in the <samp><span class="file">guide.po</span></samp> file. 
</blockquote>

   <p>Next, the messages must be translated. 
Here is a translation to a hypothetical dialect of English,
called &ldquo;Mellow&rdquo;:<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

<pre class="example">     $ cp guide.po guide-mellow.po
     <var>Add translations to</var> guide-mellow.po ...
</pre>
   <p class="noindent">Following are the translations:

<pre class="example">     <!-- file eg/data/guide-mellow.po -->
     #: guide.awk:4
     msgid "Don't Panic"
     msgstr "Hey man, relax!"
     
     #: guide.awk:5
     msgid "The Answer Is"
     msgstr "Like, the scoop is"
     
     <!-- endfile -->
</pre>
   <p><a name="index-Linux-1389"></a><a name="index-GNU_002fLinux-1390"></a>The next step is to make the directory to hold the binary message object
file and then to create the <samp><span class="file">guide.mo</span></samp> file. 
The directory layout shown here is standard for GNU <code>gettext</code> on
GNU/Linux systems.  Other versions of <code>gettext</code> may use a different
layout:

<pre class="example">     $ mkdir en_US en_US/LC_MESSAGES
</pre>
   <p><a name="index-g_t_0040code_007b_002epo_007d-files_002c-converting-to-_0040code_007b_002emo_007d-1391"></a><a name="index-files_002c-_0040code_007b_002epo_007d_002c-converting-to-_0040code_007b_002emo_007d-1392"></a><a name="index-g_t_0040code_007b_002emo_007d-files_002c-converting-from-_0040code_007b_002epo_007d-1393"></a><a name="index-files_002c-_0040code_007b_002emo_007d_002c-converting-from-_0040code_007b_002epo_007d-1394"></a><a name="index-portable-object-files_002c-converting-to-message-object-files-1395"></a><a name="index-files_002c-portable-object_002c-converting-to-message-object-files-1396"></a><a name="index-message-object-files_002c-converting-from-portable-object-files-1397"></a><a name="index-files_002c-message-object_002c-converting-from-portable-object-files-1398"></a><a name="index-g_t_0040command_007bmsgfmt_007d-utility-1399"></a>The <samp><span class="command">msgfmt</span></samp> utility does the conversion from human-readable
<samp><span class="file">.po</span></samp> file to machine-readable <samp><span class="file">.mo</span></samp> file. 
By default, <samp><span class="command">msgfmt</span></samp> creates a file named <samp><span class="file">messages</span></samp>. 
This file must be renamed and placed in the proper directory so that
<samp><span class="command">gawk</span></samp> can find it:

<pre class="example">     $ msgfmt guide-mellow.po
     $ mv messages en_US/LC_MESSAGES/guide.mo
</pre>
   <p>Finally, we run the program to test it:

<pre class="example">     $ gawk -f guide.awk
     -| Hey man, relax!
     -| Like, the scoop is 42
     -| Pardon me, Zaphod who?
</pre>
   <p>If the three replacement functions for <code>dcgettext</code>, <code>dcngettext</code>
and <code>bindtextdomain</code>
(see <a href="I18N-Portability.html#I18N-Portability">I18N Portability</a>)
are in a file named <samp><span class="file">libintl.awk</span></samp>,
then we can run <samp><span class="file">guide.awk</span></samp> unchanged as follows:

<pre class="example">     $ gawk --posix -f guide.awk -f libintl.awk
     -| Don't Panic
     -| The Answer Is 42
     -| Pardon me, Zaphod who?
</pre>
   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> Perhaps it would be better if it were
called &ldquo;Hippy.&rdquo; Ah, well.</p>

   <hr></div>

   </body></html>

