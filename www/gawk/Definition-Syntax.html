<html lang="en">
<head>
<title>Definition Syntax - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="User_002ddefined.html#User_002ddefined" title="User-defined">
<link rel="next" href="Function-Example.html#Function-Example" title="Function Example">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Definition-Syntax"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Function-Example.html#Function-Example">Function Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="User_002ddefined.html#User_002ddefined">User-defined</a>
<hr>
</div>

<h4 class="subsection">8.2.1 Function Definition Syntax</h4>

<!-- STARTOFRANGE fdef -->
<p><a name="index-functions_002c-defining-1284"></a>Definitions of functions can appear anywhere between the rules of an
<samp><span class="command">awk</span></samp> program.  Thus, the general form of an <samp><span class="command">awk</span></samp> program is
extended to include sequences of rules <em>and</em> user-defined function
definitions. 
There is no need to put the definition of a function
before all uses of the function.  This is because <samp><span class="command">awk</span></samp> reads the
entire program before starting to execute any of it.

   <p>The definition of a function named <var>name</var> looks like this:
<!-- NEXT ED: put [ ] around parameter list -->

<pre class="example">     function <var>name</var>(<var>parameter-list</var>)
     {
          <var>body-of-function</var>
     }
</pre>
   <p><a name="index-names_002c-functions-1285"></a><a name="index-functions_002c-names-of-1286"></a><a name="index-namespace-issues_002c-functions-1287"></a><var>name</var> is the name of the function to define.  A valid function
name is like a valid variable name: a sequence of letters, digits, and
underscores that doesn't start with a digit. 
Within a single <samp><span class="command">awk</span></samp> program, any particular name can only be
used as a variable, array, or function.

   <p><var>parameter-list</var> is an optional list of the function's arguments and local
variable names, separated by commas.  When the function is called,
the argument names are used to hold the argument values given in
the call.  The local variables are initialized to the empty string. 
A function cannot have two parameters with the same name, nor may it
have a parameter with the same name as the function itself.

   <p>According to the POSIX standard, function parameters cannot have the same
name as one of the special built-in variables
(see <a href="Built_002din-Variables.html#Built_002din-Variables">Built-in Variables</a>.  Not all versions of <samp><span class="command">awk</span></samp>
enforce this restriction.

   <p>The <var>body-of-function</var> consists of <samp><span class="command">awk</span></samp> statements.  It is the
most important part of the definition, because it says what the function
should actually <em>do</em>.  The argument names exist to give the body a
way to talk about the arguments; local variables exist to give the body
places to keep temporary values.

   <p>Argument names are not distinguished syntactically from local variable
names. Instead, the number of arguments supplied when the function is
called determines how many argument variables there are.  Thus, if three
argument values are given, the first three names in <var>parameter-list</var>
are arguments and the rest are local variables.

   <p>It follows that if the number of arguments is not the same in all calls
to the function, some of the names in <var>parameter-list</var> may be
arguments on some occasions and local variables on others.  Another
way to think of this is that omitted arguments default to the
null string.

   <p><a name="index-programming-conventions_002c-functions_002c-writing-1288"></a>Usually when you write a function, you know how many names you intend to
use for arguments and how many you intend to use as local variables.  It is
conventional to place some extra space between the arguments and
the local variables, in order to document how your function is supposed to be used.

   <p><a name="index-variables_002c-shadowing-1289"></a>During execution of the function body, the arguments and local variable
values hide, or <dfn>shadow</dfn>, any variables of the same names used in the
rest of the program.  The shadowed variables are not accessible in the
function definition, because there is no way to name them while their
names have been taken away for the local variables.  All other variables
used in the <samp><span class="command">awk</span></samp> program can be referenced or set normally in the
function's body.

   <p>The arguments and local variables last only as long as the function body
is executing.  Once the body finishes, you can once again access the
variables that were shadowed while the function was running.

   <p><a name="index-recursive-functions-1290"></a><a name="index-functions_002c-recursive-1291"></a>The function body can contain expressions that call functions.  They
can even call this function, either directly or by way of another
function.  When this happens, we say the function is <dfn>recursive</dfn>. 
The act of a function calling itself is called <dfn>recursion</dfn>.

<!-- @cindex @command{awk} language, POSIX version -->
<!-- @cindex POSIX @command{awk} -->
   <p><a name="index-POSIX-_0040command_007bawk_007d_002c-_0040code_007bfunction_007d-keyword-in-1292"></a>In many <samp><span class="command">awk</span></samp> implementations, including <samp><span class="command">gawk</span></samp>,
the keyword <code>function</code> may be
abbreviated <code>func</code>.  However, POSIX only specifies the use of
the keyword <code>function</code>.  This actually has some practical implications. 
If <samp><span class="command">gawk</span></samp> is in POSIX-compatibility mode
(see <a href="Options.html#Options">Options</a>), then the following
statement does <em>not</em> define a function:

<pre class="example">     func foo() { a = sqrt($1) ; print a }
</pre>
   <p class="noindent">Instead it defines a rule that, for each record, concatenates the value
of the variable &lsquo;<samp><span class="samp">func</span></samp>&rsquo; with the return value of the function &lsquo;<samp><span class="samp">foo</span></samp>&rsquo;. 
If the resulting string is non-null, the action is executed. 
This is probably not what is desired.  (<samp><span class="command">awk</span></samp> accepts this input as
syntactically valid, because functions may be used before they are defined
in <samp><span class="command">awk</span></samp> programs.) 
<!-- NEXT ED: This won't actually run, since foo() is undefined ... -->

   <p><a name="index-portability_002c-functions_0040comma_007b_007d-defining-1293"></a>To ensure that your <samp><span class="command">awk</span></samp> programs are portable, always use the
keyword <code>function</code> when defining a function.

   </body></html>

