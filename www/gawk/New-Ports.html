<html lang="en">
<head>
<title>New Ports - The GNU Awk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU Awk User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Additions.html#Additions" title="Additions">
<link rel="prev" href="Adding-Code.html#Adding-Code" title="Adding Code">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1989, 1991, 1992, 1993, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2007, 2009 Free Software Foundation, Inc.



   This is Edition 3 of `GAWK: Effective AWK Programming: A User's Guide for GNU Awk',
for the 3.1.7 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'', the Front-Cover
texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
  a. ``A GNU Manual''

  b. ``You have the freedom to copy and modify this GNU manual.  Buying
     copies from the FSF supports it in developing GNU and promoting
     software freedom.''
        -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="New-Ports"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Adding-Code.html#Adding-Code">Adding Code</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Additions.html#Additions">Additions</a>
<hr>
</div>

<h4 class="appendixsubsec">C.2.2 Porting <samp><span class="command">gawk</span></samp> to a New Operating System</h4>

<p><a name="index-portability_002c-_0040command_007bgawk_007d-1980"></a><a name="index-operating-systems_002c-porting-_0040command_007bgawk_007d-to-1981"></a>
<a name="index-porting-_0040command_007bgawk_007d-1982"></a>If you want to port <samp><span class="command">gawk</span></samp> to a new operating system, there are
several steps:

     <ol type=1 start=1>
<li>Follow the guidelines in
the previous section
concerning coding style, submission of diffs, and so on.

     <li>When doing a port, bear in mind that your code must coexist peacefully
with the rest of <samp><span class="command">gawk</span></samp> and the other ports. Avoid gratuitous
changes to the system-independent parts of the code. If at all possible,
avoid sprinkling &lsquo;<samp><span class="samp">#ifdef</span></samp>&rsquo;s just for your port throughout the
code.

     <p>If the changes needed for a particular system affect too much of the
code, I probably will not accept them.  In such a case, you can, of course,
distribute your changes on your own, as long as you comply
with the GPL
(see <a href="Copying.html#Copying">Copying</a>).

     <li>A number of the files that come with <samp><span class="command">gawk</span></samp> are maintained by other
people at the Free Software Foundation.  Thus, you should not change them
unless it is for a very good reason; i.e., changes are not out of the
question, but changes to these files are scrutinized extra carefully. 
The files are <samp><span class="file">getopt.h</span></samp>, <samp><span class="file">getopt.c</span></samp>, <samp><span class="file">getopt1.c</span></samp>,
<samp><span class="file">regex.h</span></samp>, <samp><span class="file">regex.c</span></samp>, <samp><span class="file">regcomp.c</span></samp>, <samp><span class="file">regex_internal.c</span></samp>,
<samp><span class="file">regex_internal.h</span></samp>, <samp><span class="file">regexec.c</span></samp>, <samp><span class="file">dfa.h</span></samp>, <samp><span class="file">dfa.c</span></samp>,
<samp><span class="file">install-sh</span></samp>, and <samp><span class="file">mkinstalldirs</span></samp>.

     <li>Be willing to continue to maintain the port. 
Non-Unix operating systems are supported by volunteers who maintain
the code needed to compile and run <samp><span class="command">gawk</span></samp> on their systems. If noone
volunteers to maintain a port, it becomes unsupported and it may
be necessary to remove it from the distribution.

     <li>Supply an appropriate <samp><span class="file">gawkmisc.???</span></samp> file. 
Each port has its own <samp><span class="file">gawkmisc.???</span></samp> that implements certain
operating system specific functions. This is cleaner than a plethora of
&lsquo;<samp><span class="samp">#ifdef</span></samp>&rsquo;s scattered throughout the code.  The <samp><span class="file">gawkmisc.c</span></samp> in
the main source directory includes the appropriate
<samp><span class="file">gawkmisc.???</span></samp> file from each subdirectory. 
Be sure to update it as well.

     <p>Each port's <samp><span class="file">gawkmisc.???</span></samp> file has a suffix reminiscent of the machine
or operating system for the port&mdash;for example, <samp><span class="file">pc/gawkmisc.pc</span></samp> and
<samp><span class="file">vms/gawkmisc.vms</span></samp>. The use of separate suffixes, instead of plain
<samp><span class="file">gawkmisc.c</span></samp>, makes it possible to move files from a port's subdirectory
into the main subdirectory, without accidentally destroying the real
<samp><span class="file">gawkmisc.c</span></samp> file.  (Currently, this is only an issue for the
PC operating system ports.)

     <li>Supply a <samp><span class="file">Makefile</span></samp> as well as any other C source and header files that are
necessary for your operating system.  All your code should be in a
separate subdirectory, with a name that is the same as, or reminiscent
of, either your operating system or the computer system.  If possible,
try to structure things so that it is not necessary to move files out
of the subdirectory into the main source directory.  If that is not
possible, then be sure to avoid using names for your files that
duplicate the names of files in the main source directory.

     <li>Update the documentation. 
Please write a section (or sections) for this Web page describing the
installation and compilation steps needed to compile and/or install
<samp><span class="command">gawk</span></samp> for your system.

     <li>Be prepared to sign the appropriate paperwork. 
In order for the FSF to distribute your code, you must either place
your code in the public domain and submit a signed statement to that
effect, or assign the copyright in your code to the FSF.
        </ol>

   <p>Following these steps makes it much easier to integrate your changes
into <samp><span class="command">gawk</span></samp> and have them coexist happily with other
operating systems' code that is already there.

   <p>In the code that you supply and maintain, feel free to use a
coding style and brace layout that suits your taste.

   </body></html>

