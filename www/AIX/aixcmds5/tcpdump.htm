<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>命令参考大全，卷 5，s - u - tcpdump 命令</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="dc.date" scheme="iso8601" content="2004-04-30" />
<meta name="copyright" content="(C) IBM公司版权 1997, 2004" />
<meta name="security" content="public" />
<meta name="dc.language" scheme="rfc1766" content="zh-cn" />
<meta name="Robots" content="index,follow"/>
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="owner" content="" />
<meta name="keywords" content="tcpdump, hlptcpdump" />
<link rel="stylesheet" type="text/css" href="ibmidwb.css" />
<link rel="stylesheet" type="text/css" href="text.css" />
</head>
<body>
<a id="Top_Of_Page" name="Top_Of_Page"></a> <P><center>
<B>[ <a href="tcpdump.htm#Bot_Of_Page">页的底部</a> | <a href="tcopy.htm">上一页</a> | <a href="tctl.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> |  <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>
<center><h1>命令参考大全，卷 5，s - u</h1></center>

<a name="sbewi297kbar"></a>
<h2 id="sbewi297kbar">tcpdump 命令</h2>
<p><a id="idx395" name="idx395"></a> <a id="idx396" name="idx396"></a></p>
<a name="d306d99319harr"></a>
<h3 id="d306d99319harr">用途</h3>
<a name="a39c377d590janb"></a>
<p id="a39c377d590janb">打印信息包头。</p>
<a name="d306d99613harr"></a>
<h3 id="d306d99613harr">语法</h3>
<p><span class="bold">tcpdump</span> [  <a href="tcpdump.htm#zcxui330kbar"><span class="bold">-d&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#wcxui309kbar"><span class="bold">-e&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#gdxui15akbar"><span class="bold">-f&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#a1exuid7kbar"><span class="bold">-I&nbsp;</span></a>]
[&nbsp; <a href="tcpdump.htm#gexui25kbar"><span class="bold">-n&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#uexui3c8kbar"><span class="bold">-N&nbsp;</span></a>]  [&nbsp; <a href="tcpdump.htm#jexui49kbar"><span class="bold">-O&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#dfxui283kbar"><span class="bold">-p&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#yfxui1c0kbar"><span class="bold">-q&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#pgxui394kbar"><span class="bold">-S&nbsp;</span></a>]
[&nbsp; <a href="tcpdump.htm#mgxui192kbar"><span class="bold">-t&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#dhxui3b9kbar"><span class="bold">-v&nbsp;</span></a>] [&nbsp; <a href="tcpdump.htm#shxuicckbar"><span class="bold">-x&nbsp;</span></a>]  [&nbsp; <a href="tcpdump.htm#ecxuiekbar"><span class="bold">-c&nbsp;</span></a><span class="italic">Count&nbsp;</span>] [&nbsp; <a href="tcpdump.htm#udxui2dbkbar"><span class="bold">-F&nbsp;</span></a><span class="italic">File&nbsp;</span>] [&nbsp; <a href="tcpdump.htm#ldxui389kbar"><span class="bold">-i&nbsp;</span></a><span class="italic">Interface&nbsp;</span>] [&nbsp; <a href="tcpdump.htm#pfxui1dckbar"><span class="bold">-r&nbsp;</span></a><span class="italic">File&nbsp;</span>] [&nbsp; <a href="tcpdump.htm#a6gxui282kbar"><span class="bold">-s&nbsp;</span></a><span class="italic">Snaplen&nbsp;</span>] [&nbsp; <a href="tcpdump.htm#rhxui1fbkbar"><span class="bold">-w&nbsp;</span></a><span class="italic">File&nbsp;</span>] [&nbsp;<span class="italic">Expression&nbsp;</span>]</p>
<a name="d306d99984harr"></a>
<h3 id="d306d99984harr">描述</h3>
<a name="a39c377d639janb"></a>
<p id="a39c377d639janb"><span class="bold">tcpdump</span> 命令打印从与布尔 <span class="italic">Expression</span> 参数相匹配的网络接口捕捉到的信息包头。如果没有给出<span class="italic">Expression</span>参数，所有网络上的信息包都将被转储。否则，仅当信息包的 <span class="italic">Expression</span> 参数为 True 时才会被转储。仅支持以太网、光纤分布式数据接口（FDDI）、令牌环和回送接口。访问权由 <span class="italic">/dev/bpfO</span>、<span class="italic">1</span>、<span class="italic">2</span> 和 <span class="italic">3</span> 之上的许可权控制。</p>
<a name="d306d9a252harr"></a>
<p id="d306d9a252harr"><span class="italic">Expression</span> 参数包括一个或多个<span class="italic">原语</span>。 原语通常由前面有一个或多个限定符的一个 <span class="italic">标识</span>（名称或号码）组成。限定符分三种：</p>
<a name="wq878"></a>
<table id="wq878" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="8%">
<a id="d306d9a501harr" name="d306d9a501harr"></a><span class="italic">type</span></td>
<td width="91%">  指定<span class="italic">标识</span>名或号码所指的设备种类。可能的种类有 <span class="bold">host</span>、<span class="bold">net</span> 和 <span class="bold">port</span>。示例有 <tt>hostfoo</tt>、<tt>net 128.3</tt>、<tt>port 20</tt>。如果没有类型限定符，则采用 <span class="bold">host</span>。</td>
</tr>
<tr>
<td>
<a id="d306d9a669harr" name="d306d9a669harr"></a><span class="italic">dir</span></td>
<td>  指定一个到<span class="italic">标识</span>或从其出发的特定转移方向。可能的方向有 <span class="bold">src</span>、<span class="bold">dst</span>、<span class="bold">src 或 dst</span> 以及 <span class="bold">src</span><span class="bold"> 与 dst</span>。包含 <span class="italic">dir</span> 限定符的示例如下：<tt>src foo</tt>、<tt>dst net 128.3</tt>、<tt>src</tt> 或 <tt>dst port ftp-data</tt>。如果没有 <span class="italic">dir</span> 限定符，则采用 <span class="bold">src 或 dst</span>。</td>
</tr>
<tr>
<td>
<a id="d306d9a826harr" name="d306d9a826harr"></a><span class="italic">proto</span></td>
<td>  限制与特定协议的匹配。可能的 <span class="italic">proto</span> 限定符有：<span class="bold">ether</span>、<span class="bold">ip</span>、<span class="bold">arp</span>、<span class="bold">rarp</span>、<span class="bold">tcp</span> 和 <span class="bold">udp</span>。 示例：<tt> ether src foo</tt>、<tt>arp net 128.3</tt>、<tt>tcp port 21</tt>。如果没有 <span class="italic">proto</span> 限定符，采用与该类型一致的所有协议。例如：<tt>src foo</tt> 表示 <tt>ip</tt> 或 <tt>arp</tt>，<tt>net bar</tt> 表示 <tt>ip</tt> 或 <tt>arp</tt> 或 <tt>rarp net bar</tt>，而 <tt>port 53</tt> 表示 <tt>tcp</tt> 或 <tt>udp port 53</tt>。
<a name="d306d9a963harr"></a>
<p id="d306d9a963harr">另外，有一些特殊的原语关键字不遵循这种模式：<span class="bold">broadcast</span>、<span class="bold">multicast</span>、<span class="bold">less</span>、<span class="bold">greater</span> 和算术表达式。所有这些关键字描述如下：</p></td>
</tr>
</tbody>
</table>
<a name="d306d9b152harr"></a>
<h4 id="d306d9b152harr">允许的原语</h4>
<a name="a39c377d666janb"></a>
<p id="a39c377d666janb">允许的原语如下所示：</p>
<a name="wq879"></a>
<table id="wq879" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="28%">
<a id="d306d9b448harr" name="d306d9b448harr"></a><span class="bold">dst host</span><span class="italic"> Host</span></td>
<td width="71%">  如果信息包的 IP（网际协议）目的地字段值与 <span class="italic">Host</span> 变量（可以是一个地址或名称）的值相同时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9b599harr" name="d306d9b599harr"></a><span class="bold">src host</span><span class="italic"> Host</span></td>
<td>  当信息包的 IP 源字段值与 <span class="italic">Host</span> 变量值相同时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9b763harr" name="d306d9b763harr"></a><span class="bold">host</span><span class="italic"> Host </span></td>
<td>  当信息包的 IP 源或目的地值与 <span class="italic">Host</span> 变量值相同时为真。以上的任意 <span class="bold">host</span> 表达式可前置关键字 <span class="bold">ip</span>、<span class="bold">arp</span> 或 <span class="bold">rarp</span>，如下：
<a name="d306d9b899harr"></a>
<p id="d306d9b899harr"><span class="bold">ip host</span><span class="italic"> Host</span></p> 
<a name="d306d9c053harr"></a>
<p id="d306d9c053harr">如果 <span class="italic">Host</span> 变量是带有多个 IP 地址的名称，则检测每一地址是否有匹配。</p></td>
</tr>
<tr>
<td>
<a id="d306d9c213harr" name="d306d9c213harr"></a><span class="bold">dst net</span><span class="italic"> Net</span></td>
<td>  当信息包的 IP 目的地地址值有一个网络号 <span class="italic">Net</span> 时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9c364harr" name="d306d9c364harr"></a><span class="bold">src net</span><span class="italic"> Net</span></td>
<td>  信息包的 IP 源地址值有一个网络号 <span class="italic">Net</span> 时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9c523harr" name="d306d9c523harr"></a><span class="bold">net</span><span class="italic"> Net </span></td>
<td>  当信息包的 IP 源或目的地地址值有一个网络号 <span class="italic">Net</span> 时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9c699harr" name="d306d9c699harr"></a><span class="bold">dst port</span><span class="italic"> Port</span></td>
<td>  当信息包为 TCP/IP（传输控制协议/网际协议）或 IP/UDP（网际协议/用户数据报协议）并且有一个目的地端口值 <span class="italic">Port</span> 时为真。此端口可以是一个数字或用在 <span class="italic">/etc/services</span> 中的名称。如果使用了名称，则端口号和协议都进行检测。如果使用了一个数字或不明确的名称，则只检测端口号（<tt>dst port 513</tt> 将打印 TCP/login 流量和 UDP/who 流量，而且 <tt>port domain</tt> 将打印 TCP／域和 UDP／域流量）。</td>
</tr>
<tr>
<td>
<a id="d306d9c822harr" name="d306d9c822harr"></a><span class="bold">src port</span><span class="italic"> Port</span></td>
<td>  当 <span class="italic">Port</span> 变量的值与源端口的值相同时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9c986harr" name="d306d9c986harr"></a><span class="bold">port</span><span class="italic"> Port</span></td>
<td>  当信息包的源或目的地端口值为 <span class="italic">Port</span> 时为真。以上任意 <span class="bold">port</span> 表达式可以前置关键字 <span class="bold">tcp</span> 或 <span class="bold">udp</span>，如下所示：
<a name="d306d9d131harr"></a>
<p id="d306d9d131harr"><span class="bold">tcp src port</span><span class="italic"> port</span></p> 
<a name="d306d9d276harr"></a>
<p id="d306d9d276harr">它只与 TCP 信息包相匹配。</p></td>
</tr>
<tr>
<td>
<a id="d306d9d460harr" name="d306d9d460harr"></a><span class="bold">less</span><span class="italic"> Length</span></td>
<td>  当信息包的长度小于或等于 <span class="italic">Length</span> 时为真。它相当于：
<a name="d306d9d584harr"></a>
<p id="d306d9d584harr"><span class="bold">len</span> &lt; = <span class="italic">Length</span>.</p></td>
</tr>
<tr>
<td>
<a id="d306d9d735harr" name="d306d9d735harr"></a><span class="bold">greater</span><span class="italic"> Length</span></td>
<td>  当信息包的长度大于或等于 <span class="italic">Length</span> 变量时为真。它相当于：
<a name="d306d9d886harr"></a>
<p id="d306d9d886harr"><span class="bold">len</span> &gt; = <span class="italic">Length</span></p></td>
</tr>
<tr>
<td>
<a id="d306d9e012harr" name="d306d9e012harr"></a><span class="bold">ip proto</span><span class="italic"> Protocol</span></td>
<td>  当信息包为 <span class="italic">Protocol</span> 协议类型的 IP 信息包时为真。<span class="italic">Protocol</span> 可以是一个数字或以下名称：<span class="bold">icmp</span><span class="italic">、</span><span class="bold">udp</span><span class="italic"></span> 或 <span class="bold">tcp</span>。
<p></p><blockquote><span class="bold">注：</span>标识符 <span class="bold">tcp</span>、<span class="bold">udp</span> 和 <span class="bold">icmp</span> 也是关键字，必须通过 \ (反斜线符号)（在 korn-shell 中为 \\ (双反斜线符号)）进行转义。</blockquote></td>
</tr>
<tr>
<td>
<a id="d306d9e299harr" name="d306d9e299harr"></a><span class="bold">ip broadcast</span></td>
<td>  当信息包为 IP 广播信息包时为真。它检测所有的全 0 和全 1 广播约定，并查找本地子网掩码。</td>
</tr>
<tr>
<td>
<a id="d306d9e447harr" name="d306d9e447harr"></a><span class="bold">ip multicast</span></td>
<td>  当信息包为 IP 多点广播信息包时为真。</td>
</tr>
<tr>
<td>
<a id="d306d9e632harr" name="d306d9e632harr"></a><span class="bold">proto</span><span class="italic"> Protocol</span></td>
<td>  当信息包为 <span class="italic">Protocol</span> 类型时为真。<span class="italic">Protocol</span> 可以是一个数字或一个名称如 <span class="bold">ip</span>、<span class="bold">arp</span> 或 <span class="bold">rarp</span>。
<p></p><blockquote><span class="bold">注：</span>这些标识符也是关键字，并且必须通过 \ (反斜杠)转义。</blockquote></td>
</tr>
<tr>
<td>
<a id="d306d9e941harr" name="d306d9e941harr"></a><span class="bold">ip</span>、<span class="bold">arp</span>、<span class="bold">rarp</span></td>
<td>  缩略语：
<a name="d306d9f111harr"></a>
<p id="d306d9f111harr"><span class="bold">proto</span><span class="italic"> p</span></p> 
<a name="d306d9f276harr"></a>
<p id="d306d9f276harr">其中 <span class="italic">p</span> 是上述协议之一。</p></td>
</tr>
<tr>
<td>
<a id="d306d9f436harr" name="d306d9f436harr"></a><span class="bold">tcp</span>、<span class="bold">udp</span>、<span class="bold">icmp</span></td>
<td>  缩略语：
<a name="d306d9f548harr"></a>
<p id="d306d9f548harr"><span class="bold">ip proto</span><span class="italic"> p</span></p> 
<a name="d306d9f715harr"></a>
<p id="d306d9f715harr">其中 <span class="italic">p</span> 是上述协议之一。</p></td>
</tr>
</tbody>
</table>
<a name="d306d9f832harr"></a>
<h4 id="d306d9f832harr">表达式参数的关系运算符</h4>
<a name="a39c377d722janb"></a>
<p id="a39c377d722janb">简单关系：</p>
<a name="d306da0162harr"></a>
<p id="d306da0162harr"><span class="italic">expr replop expr</span></p>
<a name="a39c377d757janb"></a>
<p id="a39c377d757janb">当 <span class="italic">relop</span> 为 &gt;（大于）, &lt;（小于），&gt;=（不等于），
&lt;= (小于或等于)，= (等于)， != (叹号与等号)之一时为真，而 <span class="italic">expr</span> 是由整常数（以标准 C 语法表示），
常用二目运算符 +（加号），-（减号），*&nbsp;（乘号），/ (除号), &amp; (与号), | (或号)，长度运算符和特殊包数据附件组成的算术表达式。要存取信息包里的数据，请使用以下语法：</p>
<a name="d306da0466harr"></a>
<p id="d306da0466harr"><span class="italic">proto</span><span class="bold"> [</span><span class="italic"> expr</span><span class="bold"> :</span><span class="italic"> size</span><span class="bold"> ]</span></p>
<a name="a39c377d798janb"></a>
<p id="a39c377d798janb"><span class="italic">Proto</span> 是关键字 <span class="bold">ip</span>、<span class="bold">arp</span>、<span class="bold">rarp</span>、<span class="bold">tcp</span> 或 <span class="bold">icmp</span> 之一，并表示索引操作的协议层。与所指协议层相关的字节偏移量由 <span class="italic">expr</span> 给出。指示符 <span class="italic">size</span> 可选，它指示所感兴趣字段里的字节数；它可以是一个、两个或四个，缺省设为一个字节。由关键字 <span class="bold">len</span> 表示的长度操作符，给出了信息包的长度。</p>
<a name="a39c377d833janb"></a>
<p id="a39c377d833janb">例如，表达式 <tt>ip[0] &amp; 0xf !</tt><tt>=</tt><tt> 5</tt> 仅捕捉非片断数据报和片断数据报的 <tt>0</tt> 片断。该检测暗指 <span class="bold">tcp</span> 和 <span class="bold">udp</span> 索引操作。例如：<span class="bold">tcp[0]</span> 通常意味着 TCP 报头的第一字节，而从不表示中间片断的第一个字节。</p>
<a name="d306da0914harr"></a>
<h4 id="d306da0914harr">组合原语</h4>
<a name="a39c377d884janb"></a>
<p id="a39c377d884janb">更复杂的过滤表达式的建立可以通过使用 <span class="bold">and</span>、<span class="bold">or</span> 和 <span class="bold">not</span> 来组合原语。例如: <tt>host foo and not port ftp and not port ftp-data</tt>。为了减少输入，可以省略相同的限定符列表。例如: <tt>tcp dst port ftp or ftp-data or domain</tt> 与 <tt>tcp dst port ftp or tcp dst port ftp-data or tcp dst port domain</tt> 完全相同。</p>
<a name="a39c377d914janb"></a>
<p id="a39c377d914janb">通过使用括入括号的原语和操作符组（括号是 Shell 专用的，且必须转义）可以组合原语。</p>
<ul>
<li><a name="d306da1331harr"></a><span id="d306da1331harr" class="pk"></span>A</li>
<li><a name="d306da1469harr"></a><span id="d306da1469harr" class="pk"></span>非（`!' 或 `<span class="bold">not</span>'）。</li>
<li><a name="d306da1617harr"></a><span id="d306da1617harr" class="pk"></span>与 (`<span class="bold">and</span>')。</li>
<li><a name="d306da1749harr"></a><span id="d306da1749harr" class="pk"></span>或 (`<span class="bold">or</span>')。</li></ul>
<a name="a39c377d967janb"></a>
<p id="a39c377d967janb">“非”具有最高优先顺序。“或”和“与”具有相同的优先顺序，并按由左向右的顺序执行。</p>
<a name="a39c377e006janb"></a>
<p id="a39c377e006janb">如果给出了一个没有关键字的标识符，则采用最近使用的关键字。例如：</p>
<p></p>
<a name="d306da2215harr"></a>
<pre id="d306da2215harr" class="xmp">not host gil and devo </pre>
<a name="a39c377e047janb"></a>
<p id="a39c377e047janb">是</p>
<p></p>
<a name="d306da2514harr"></a>
<pre id="d306da2514harr" class="xmp">not host gil and host devo </pre>
<a name="a39c377e087janb"></a>
<p id="a39c377e087janb">的缩略语，不要与</p>
<p></p>
<a name="d306da2792harr"></a>
<pre id="d306da2792harr" class="xmp">not \(host gil or devo\) 相混淆。</pre>
<a name="a39c377e128janb"></a>
<p id="a39c377e128janb">表达式参数可作为单参数或多参数（两者中较方便的）传递给 <span class="bold">tcpdump</span> 命令。通常，如果表达式包含 Shell 元字符，将其作为单个的、加引号的参数来传递会更容易。多参数在分析之前以空格相连。</p>
<a name="d306da2993harr"></a>
<h4 id="d306da2993harr">协议输出格式</h4>
<a name="a39c377e172janb"></a>
<p id="a39c377e172janb"><span class="bold">tcpdump</span> 命令的输出随协议而定。下面是大多数输出格式的简要描述和示例。</p>
<a name="d306da3139harr"></a>
<h5 id="d306da3139harr">TCP 信息包</h5>
<a name="a39c377e207janb"></a>
<p id="a39c377e207janb">TCP 协议行的通用格式为：</p>
<p></p>
<a name="d306da3319harr"></a>
<pre id="d306da3319harr" class="xmp">src  &gt;  dst: flags data-seqno ack win urg options</pre>
<a name="a39c377e241janb"></a>
<p id="a39c377e241janb">在下列字段列表中，<tt>src、</tt><tt>dst</tt> 和 <tt>flags</tt> 一直存在。其它字段取决于信息包的 TCP 协议头的内容，并仅在适当的时候输出。</p>
<a name="wq880"></a>
<table id="wq880" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="16%">
<a id="d306da3489harr" name="d306da3489harr"></a><tt>src</tt></td>
<td width="83%">  指示源（主机）地址和端口。总是指定 <tt>src</tt> 字段。</td>
</tr>
<tr>
<td>
<a id="d306da3564harr" name="d306da3564harr"></a><tt>dst</tt></td>
<td>  指示目的地址和端口。<tt>dst</tt>字段总是被指定。</td>
</tr>
<tr>
<td>
<a id="d306da3952harr" name="d306da3952harr"></a><tt>flags</tt></td>
<td>  指定标志 S（SYN）、F（FIN）、P（PUSH）或 R（RST）的组合或单个<span class="bold">.</span>（句点）来指示没有标记。总是指定 <tt>flags</tt> 字段。</td>
</tr>
<tr>
<td>
<a id="d306da4042harr" name="d306da4042harr"></a><tt>data-seqno</tt></td>
<td>  描述该信息包中数据占据的序列空间部分（请参阅下面示例）。</td>
</tr>
<tr>
<td>
<a id="d306da4185harr" name="d306da4185harr"></a><tt>ack</tt></td>
<td>  指定（通过应答）在该连接的其它方向上预期的下一数据的序列号。</td>
</tr>
<tr>
<td>
<a id="d306da4548harr" name="d306da4548harr"></a><tt>win</tt></td>
<td>  指定该连接的其它方向上可用的接收缓冲空间的字节数。</td>
</tr>
<tr>
<td>
<a id="d306da4724harr" name="d306da4724harr"></a><tt>urg</tt></td>
<td>  指示该信息包中有紧急数据。</td>
</tr>
<tr>
<td>
<a id="d306da4834harr" name="d306da4834harr"></a><tt>options</tt></td>
<td>  指定在尖括号中的 TCP 选项（例如：<tt>&lt; mss 1024&gt;</tt>）。</td>
</tr>
</tbody>
</table>
<a name="a39c377e280janb"></a>
<p id="a39c377e280janb"><span class="bold">rlogin</span> 命令从主机 <tt>gil</tt> 到主机 <tt>devo</tt> 的开始部分为：</p>
<p></p>
<a name="d306da5154harr"></a>
<pre id="d306da5154harr" class="xmp">gil.1023 &gt; devo.login:S 768512:768512(0) win 4096 &lt;mss 1024&gt;
devo.login &gt; gil.1023:S 947648:947648(0) ack 768513 win 4096 &lt;mss
1024&gt;
gil.1023 &gt; devo.login: . ack 1 win 4096
gil.1023 &gt; devo.login: P 1:2(1) ack 1 win 4096
devo.login &gt; gil.1023: ack 2 win 4096
gil.1023 &gt; devo.login: P 2:21(19) ack 1 win 4096
devo.login &gt; gil.1023: P 1:2(1) ack 21 win 4077
devo.login &gt; gil.1023: P 2:3(1) ack 21 win 4077 urg 1
devo.login &gt; gil.1023: P 3:4(1) ack 21 win 4077 urg 1</pre>
<a name="a39c377e311janb"></a>
<p id="a39c377e311janb">第一行是指主机 <tt>gil</tt> 上的 TCP 端口 1023 向主机&nbsp;<tt>devo</tt> 的<tt>登录</tt>端口发送一个信息包。这个 <tt>S&nbsp;</tt>表明已经设置 SYN 标志。信息包的序列号为 <tt>768512</tt>，它不含数据。(标记“first:last（nbytes）”意味着“序列号<span class="italic"> first </span>上限可达但不包含<span class="italic"> last</span>，即用户数据为<span class="italic"> nbytes </span>字节”。）不含带外部关联的 <tt>ack</tt> 字段，可用接收字段 <tt>win</tt> 为 <tt>4096</tt> 字节，并且最大段大小（mss）选项要求 <tt>1024</tt> 字节的 <tt>mss</tt>。</p>
<a name="a39c377e335janb"></a>
<p id="a39c377e335janb">主机 <tt>Devo</tt> 以一个类似的包答复，但该信息包内含有一个有外部关联 <tt>ack</tt> 字段，用于主机 <tt>gil</tt>的 SYN。然后，主机<tt> gil </tt>应答主机<tt> devo </tt>的 SYN。<span class="bold">.</span> (句点)表示没有设置标志。该信息包不含数据，所以也就没有数据序列号。</p>
<p></p><blockquote><a name="d306da5396harr"></a><span id="d306da5396harr" class="pk"></span><span class="bold">注：</span><tt>ack</tt> 字段序列号为一个小整数（1）。</blockquote>
<a name="a39c377e373janb"></a>
<p id="a39c377e373janb">当 <span class="bold">tcpdump</span> 第一次遇到 TCP 对话时，它从该信息包中打印序列号。在随后的对话信息包中，打印了当前信息包的序列号与该初始序列号的差异。这意味着第一个之后的序列号可以解释为对话数据流中的相对字节位置（每个方向的第一个数据字节为 1）。<span class="bold">-S</span>标记覆盖该特性，并导致输出原序列号。</p>
<a name="a39c377e544janb"></a>
<p id="a39c377e544janb">在第六行，主机 <tt>gil</tt> 发送给主机 devo <tt>19</tt> 字节的数据（在<tt> gil-devo </tt>对话侧的第 2 字节到第 20 字节）。在信息包内设置了 PUSH 标志。在第七行，主机 <tt>devo</tt> 声称它收到了主机 <tt>gil</tt> 发送的上限可达到但不包含第 <tt>21</tt> 字节的数据。因为 <tt>devo</tt> 的接收窗口收到较小的 19 字节，这一数据的大部分显然位于套接字缓冲区。主机 <tt>devo</tt> 还发送其信息包内的一个字节的数据给主机 <tt>gil</tt>。在第八、九行，主机 <tt>devo</tt> 发送两字节的 <tt>urgent</tt><tt> PUSH</tt> 数据到主机 <tt>gil</tt>。</p>
<a name="d306da5641harr"></a>
<h5 id="d306da5641harr">UDP 信息包</h5>
<a name="a39c377e585janb"></a>
<p id="a39c377e585janb">该 <span class="bold">rwho</span> 命令信息包说明 UDP 格式：</p>
<p></p>
<a name="d306da5791harr"></a>
<pre id="d306da5791harr" class="xmp">devo.who &gt; bevo.who: udp 84</pre>
<a name="a39c377e633janb"></a>
<p id="a39c377e633janb">该命令序列说明主机 <tt>devo</tt> 的端口 <tt>who</tt> 发送一个 <tt>udp</tt> 数据报给主机 <tt>bevo</tt> 的端口 <tt>who</tt>。该信息包内含有 <tt>84</tt> 字节的用户数据。</p>
<a name="a39c377e672janb"></a>
<p id="a39c377e672janb">一些 UDP 服务（从源或目的地端口号）可被识别，并且打印出更高层的协议信息。尤其是域名服务请求（RFC-1034/1035）和到 NFS 的 Sun RPC 呼叫（RFC-1050）。</p>
<a name="d306da6142harr"></a>
<h5 id="d306da6142harr">UDP 名称服务器请求</h5>
<a name="a39c377e712janb"></a>
<p id="a39c377e712janb">名称服务器请求格式为：</p>
<p></p>
<a name="d306da6574harr"></a>
<pre id="d306da6574harr" class="xmp">src &gt; dst: id op? flags qtype qclass name (len)</pre>
<a name="a39c377e750janb"></a>
<p id="a39c377e750janb">除了上述字段，UDP 名称服务器请求包含以下内容：</p>
<a name="wq881"></a>
<table id="wq881" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="5%">
<a id="d306da7112harr" name="d306da7112harr"></a><tt>id</tt></td>
<td width="95%">  指定查询的标识号。</td>
</tr>
<tr>
<td>
<a id="d306da7260harr" name="d306da7260harr"></a><tt>op</tt></td>
<td>  指定操作类型。缺省为查询操作。</td>
</tr>
</tbody>
</table>
<a name="d306da7407harr"></a>
<p id="d306da7407harr"><tt>qclass</tt></p>
<a name="d306da7526harr"></a>
<p id="d306da7526harr"><tt>name</tt></p>
<a name="d306da7647harr"></a>
<p id="d306da7647harr"><tt>(len)</tt></p>
<a name="a39c377e794janb"></a>
<p id="a39c377e794janb">下面是名称服务器的请求示例：</p>
<p></p>
<a name="d306da7947harr"></a>
<pre id="d306da7947harr" class="xmp">tnegev.1538 &gt; tnubia.domain: 3+ A? austin.ibm.com. (37)</pre>
<a name="a39c377e842janb"></a>
<p id="a39c377e842janb">主机 <tt>tnegev</tt> 向 <tt>tnubia</tt> 上的域服务器询问与名称 <tt>austin.ibm.com</tt> 关联的地址记录（<tt> qtype</tt>=A）。查询 id 为<tt> 3</tt>。<tt>+</tt>（加号）表示已经设置递归要求标志。查询长度为 <tt>37</tt> 字节，不包含 UDP 和 IP 协议头。查询为标准操作 Query，所以省略 op 字段。如果 op 为其它值，它会在 <tt>3</tt> 和 <tt>+</tt> 之间打印出来。类似地，qclass 为一标准类（<span class="italic"> C_IN</span>) 也被省略。任何其它 qclass 会直接在 <tt>A</tt> 之后打印出来。</p>
<a name="a39c377e881janb"></a>
<p id="a39c377e881janb">会检查一些异常，这可能会使方括号内包含额外的字段。如果查询包含应答、名称服务器或权限段，则 <span class="italic">ancount</span>、<span class="italic">nscount</span> 或 <span class="italic">arcount</span> 打印为 <span class="italic">n</span>a]，[<span class="italic">n</span>n] 或 [<span class="italic">n</span>au]，其中 <span class="italic">n</span> 为适当的计数。如果设置了任一响应位（AA，RA，或 rcode）或者设置了字节 2 和 3 的任意“必须为零”位，[b2&amp;3=<span class="italic">x</span>] 会被打印出来，其中 <span class="italic">x</span> 是头字节 2 和 3 的十六进制值。</p>
<a name="d306da8453harr"></a>
<h5 id="d306da8453harr">UDP 名称服务器响应</h5>
<a name="a39c377e932janb"></a>
<p id="a39c377e932janb">名称服务器响应格式为：</p>
<p></p>
<a name="d306da8742harr"></a>
<pre id="d306da8742harr" class="xmp">src &gt; dst: id op rcode flags a/n/au type class data (len)</pre>
<a name="a39c377e962janb"></a>
<p id="a39c377e962janb">除以上所述字段外，UDP 名称服务器响应包括以下内容：</p>
<a name="d306da9040harr"></a>
<p id="d306da9040harr"><tt>rcode</tt></p>
<a name="d306da9187harr"></a>
<p id="d306da9187harr"><tt>data</tt></p>
<a name="a39c377f003janb"></a>
<p id="a39c377f003janb">下面是名称服务器响应的一个示例：</p>
<p></p>
<a name="d306da9657harr"></a>
<pre id="d306da9657harr" class="xmp">tnubia.domain &gt; tnegev.1538: 3 3/3/7 A 129.100.3
tnubia.domain &gt; tnegev.1537: 2 NXDomain* 0/1/0 (97)</pre>
<a name="a39c377f043janb"></a>
<p id="a39c377f043janb">在第一个示例中，<tt>tnubia</tt> 以 <tt>3</tt> 回答记录、<tt>3&nbsp;</tt>名称服务器记录和 <tt>7</tt> 权限记录响应来自 <tt>tnegev</tt> 的查询 <tt>3</tt>。第一个回答记录为 <tt>A</tt> 类（地址），其数据为 internet 地址 <tt> 129.100.100.3</tt>。响应共计 273 字节，不含 UDP 和 IP 头。与 <tt>A</tt> 记录的类（C_IN）的情形相似，省略了 op（Query）和响应代码（NoError）。</p>
<a name="a39c377f083janb"></a>
<p id="a39c377f083janb">在第二个示例中，<tt>tnubia</tt> 以一个不存在的域的响应代码（<tt>NXDomain</tt>）和 <tt>0</tt> 回答记录，<tt>1</tt> 名称服务器记录和 <tt>0</tt> 权限记录响应查询 <tt>2</tt>。<tt>*&nbsp;</tt>（星号）表示设置了授权回答位。因为没有回答，所以不打印类型、类或数据。</p>
<a name="a39c377f132janb"></a>
<p id="a39c377f132janb">其它可能显示的标志字符有 <tt>-</tt>（递归可用，RA，<span class="italic">未</span>设置）和 <tt>|</tt>（截断的消息，TC，已设置）。</p>
<p></p><blockquote><a name="d306daa318harr"></a><span id="d306daa318harr" class="pk"></span><span class="bold">注：</span>名称服务器请求和响应可能很大，80 字节的缺省 snaplen 有可能不能捕捉足够的信息包以打印。如果需要调查大量的名称服务器流量，用 <span class="bold">-s</span> 标志来增加 snaplen。</blockquote>
<a name="d306daa442harr"></a>
<h5 id="d306daa442harr">NFS 请求</h5>
<a name="a39c377f164janb"></a>
<p id="a39c377f164janb">Sun NFS（网络文件系统）请求与答复的格式为：</p>
<p></p>
<a name="d306daa750harr"></a>
<pre id="d306daa750harr" class="xmp">src.xid &gt; dst.nfs: len op args
src.nfs &gt; dst.xid: reply stat len</pre>
<a name="a39c377f204janb"></a>
<p id="a39c377f204janb">除以上所述字段外，NFS 请求和响应包括以下这些字段：</p>
<a name="wq882"></a>
<table id="wq882" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="16%">
<a id="d306dab063harr" name="d306dab063harr"></a><tt>args</tt></td>
<td width="83%">  指定目录文件 $file handle$。</td>
</tr>
<tr>
<td>
<a id="d306dab143harr" name="d306dab143harr"></a><tt>reply stat</tt></td>
<td>  表示操作的响应状态。</td>
</tr>
</tbody>
</table>
<a name="a39c377f249janb"></a>
<p id="a39c377f249janb">下面是 NFS 请求与响应的一个示例：</p>
<p></p>
<a name="d306dab500harr"></a>
<pre id="d306dab500harr" class="xmp">L1.e2766 &gt; L2.nfs: 136 readdir fh 6.5197 8192 bytes @ 0
L2.nfs &gt; L1.e2766: reply ok 384
L1.e2767 &gt; L2.nfs: 136 lookup fh 6.5197 `RCS'</pre>
<a name="a39c3780042janb"></a>
<p id="a39c3780042janb">在第一行，主机 <tt>L1</tt> 发送一个 id 为 <tt>e2766</tt> 的事务到 <tt>L2</tt>（注意，<tt>src</tt> 主机后面的数字是事务号，而非源端口）。请求为 <tt>136</tt> 字节，不含 UDP 和 IP 头。操作为在文件句柄（<tt>fh</tt>）<tt>6.5197</tt> 上的 <tt>readir</tt>（读目录）。开始于偏移量<tt>0，8192</tt> 字节被读取。<tt>L2</tt> 以 <tt>384</tt> 字节数据应答 <tt>ok</tt>。</p>
<a name="a39c3780072janb"></a>
<p id="a39c3780072janb">在第三行，<tt>L1</tt> 要求 <tt>L2</tt> 在目录文件 <tt>6.5197</tt> 中查询名称<tt>“RCS”</tt>。注意：打印的数据取决于操作类型。</p>
<p></p><blockquote><a name="d306dab965harr"></a><span id="d306dab965harr" class="pk"></span><span class="bold">注：</span>NFS 请求非常大，除非增加 <span class="italic">snaplen</span>，否则以上内容不会打印出来。用标记 <span class="bold">-s 192</span> 观察 NFS 流量。</blockquote>
<a name="d306dac190harr"></a>
<h5 id="d306dac190harr">ARP/RARP 信息包</h5>
<a name="a39c3780113janb"></a>
<p id="a39c3780113janb">地址解析协议／反向地址解析协议（ARP/RARP）输出表示请求的类型和其参数。下面的示例显示了从主机 <tt>devo</tt> 到主机 <tt>bevo</tt> 的 <span class="bold">rlogin</span> 命令的启动：</p>
<p></p>
<a name="d306dac619harr"></a>
<pre id="d306dac619harr" class="xmp">arp who-has bevo tell devo
arp reply bevo is-at 1d:2d:3d:4d:5d:6d</pre>
<a name="a39c3780144janb"></a>
<p id="a39c3780144janb">第一行是 <tt>devo</tt> 发送了一个 ARP 包，询问因特网主机 <tt>bevo</tt> 的以太网地址。在第二行，<tt>bevo</tt> 以它的以太网地址答复。</p>
<a name="d306dac847harr"></a>
<h5 id="d306dac847harr">IP 片断</h5>
<a name="a39c3780184janb"></a>
<p id="a39c3780184janb">片断因特网数据报打印如下：</p>
<p></p>
<a name="d306dad146harr"></a>
<pre id="d306dad146harr" class="xmp"><span class="bold">(frag</span> id<span class="bold">:</span>size<span class="bold">@</span>offset+<span class="bold">)</span>
<span class="bold">(frag</span> id<span class="bold">:</span>size<span class="bold">@</span>offset<span class="bold">)</span></pre>
<a name="a39c3780235janb"></a>
<p id="a39c3780235janb">第一个表单表明有更多的片断。第二个表明这是最后的片断。IP 片断有以下字段：</p>
<a name="wq883"></a>
<table id="wq883" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="10%">
<a id="d306dad460harr" name="d306dad460harr"></a><tt>id</tt></td>
<td width="90%">  标识片断。</td>
</tr>
<tr>
<td>
<a id="d306dad611harr" name="d306dad611harr"></a><tt>size</tt></td>
<td>  指定片断大小（按字节）包括 IP 头。</td>
</tr>
<tr>
<td>
<a id="d306dad780harr" name="d306dad780harr"></a><tt>offset</tt></td>
<td>  指定原数据报中的片断偏移量（按字节）。</td>
</tr>
</tbody>
</table>
<a name="a39c3780277janb"></a>
<p id="a39c3780277janb">片断信息按每一片断输出。第一片断包括较高层的协议报头而片断信息在协议信息之后打印。第一个之后的片断不包含更高层的协议头，而片断信息在源和目的地地址之后打印。例如一个 ping echo/reply 序列：</p>
<p></p>
<a name="d306dae123harr"></a>
<pre id="d306dae123harr" class="xmp">gil &gt; devo: icmp: echo request (
frag 34111: 1480@0+)
gil &gt; devo: (frag 34111!28@1480)
devo &gt; gil: icmp: echo reply (frag
                   15314:148@0+)</pre>
<a name="a39c3780321janb"></a>
<p id="a39c3780321janb">一个带<span class="italic">“请勿拆分”</span> IP 标志的信息包以一个<span class="bold">（DF）</span>在结尾标记。</p>
<a name="d306dae346harr"></a>
<h5 id="d306dae346harr">时间戳</h5>
<a name="a39c3780362janb"></a>
<p id="a39c3780362janb">缺省情况下，所有输出行前置一个时间戳。时间戳为表单内的当前时钟时间。</p>
<p></p>
<a name="d306dae537harr"></a>
<pre id="d306dae537harr" class="xmp">hh:mm:ss.frac</pre>
<a name="a39c3780402janb"></a>
<p id="a39c3780402janb">并且与内核的时钟一样精确。时间戳反映了内核第一次发现包的时间。没有尝试去说明以太网接口从线上除去信息包到内核服务新信息包中断之间的时间迟延。</p>
<a name="d306dae903harr"></a>
<h3 id="d306dae903harr">标志</h3>
<p></p>
<a name="wq884"></a>
<table id="wq884" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="5%">
<a id="ecxuiekbar" name="ecxuiekbar"></a><span class="bold">-c</span></td>
<td width="95%">  在收到<span class="italic"> Count </span>包后退出。</td>
</tr>
<tr>
<td>
<a id="zcxui330kbar" name="zcxui330kbar"></a><span class="bold">-d</span></td>
<td>  转储编译过的信息包匹配代码至标准输出，然后停止。</td>
</tr>
<tr>
<td>
<a id="wcxui309kbar" name="wcxui309kbar"></a><span class="bold">-e</span></td>
<td>  在每一转储行打印链接层头。如果指定了<span class="bold">-e </span>标记，则打印出链接层头。在以太网和令牌环网上，源地址和目的地地址、协议、信息包长度被打印出来。</td>
</tr>
<tr>
<td>
<a id="gdxui15akbar" name="gdxui15akbar"></a><span class="bold">-f</span></td>
<td>  以数字而非符号方式打印外部网际网地址。</td>
</tr>
<tr>
<td>
<a id="udxui2dbkbar" name="udxui2dbkbar"></a><span class="bold">-F</span></td>
<td>  将 <span class="italic">File</span> 用作过滤表达式的输入。<span class="bold">-F</span> 标记忽略命令行上给出的任何附加的表达式。</td>
</tr>
<tr>
<td>
<a id="ldxui389kbar" name="ldxui389kbar"></a><span class="bold">-i</span></td>
<td>  在 <span class="italic">Interface</span> 上侦听。如果未指定，<span class="bold">tcpdump</span> 命令在系统接口列表中查找已经在工作的最低计数和已配置的接口。该搜索排除了回送接口。</td>
</tr>
<tr>
<td>
<a id="a1exuid7kbar" name="a1exuid7kbar"></a><span class="bold">-I</span></td>
<td>  （大写字母 i）指定直接信息包捕捉方式。<span class="bold">-l</span> 标记不等待缓冲区填充。</td>
</tr>
<tr>
<td>
<a id="d306daf843harr" name="d306daf843harr"></a><span class="bold">-l</span></td>
<td>  （小写字母 L）缓冲标准输出行（stdout）。该标记用于在捕捉数据时查看数据。例如：
<p></p>
<a name="d306daf975harr"></a>
<pre id="d306daf975harr" class="xmp">tcpdump -l : tee dat

 或 tcpdump -l &gt; dat &amp; tail -f dat</pre></td>
</tr>
<tr>
<td>
<a id="gexui25kbar" name="gexui25kbar"></a><span class="bold">-n</span></td>
<td>  省略地址到名称的转换。</td>
</tr>
<tr>
<td>
<a id="uexui3c8kbar" name="uexui3c8kbar"></a><span class="bold">-N</span></td>
<td>  省略打印主机名的域名资格。例如，<span class="bold">-N</span> 标记打印 <tt>gil</tt> 而不是 <tt>gil.austin.ibm.com</tt>。</td>
</tr>
<tr>
<td>
<a id="jexui49kbar" name="jexui49kbar"></a><span class="bold">-O</span></td>
<td>  省略运行信息包匹配代码优化器。这仅在怀疑优化器中存在故障时有用。</td>
</tr>
<tr>
<td>
<a id="dfxui283kbar" name="dfxui283kbar"></a><span class="bold">-p</span></td>
<td>  指定接口不在混杂方式下运行。
<p></p><blockquote><span class="bold">注：</span>接口可能因其它原因而处于混杂方式；因此，<span class="bold">-p </span>不可被用作“ether host {localhost}”或“broadcast”的缩写。</blockquote></td>
</tr>
<tr>
<td>
<a id="yfxui1c0kbar" name="yfxui1c0kbar"></a><span class="bold">-q</span></td>
<td>  静默输出。<span class="bold">-q</span> 标记打印较少的协议信息，所以输出行较短。</td>
</tr>
<tr>
<td>
<a id="pfxui1dckbar" name="pfxui1dckbar"></a><span class="bold">-r</span></td>
<td>  从 <span class="italic">File</span> 中读取包（它是用<span class="bold"> -w </span>选项创建的）。当 <span class="italic">File</span> 为“-”时使用标准输入。</td>
</tr>
<tr>
<td>
<a id="a6gxui282kbar" name="a6gxui282kbar"></a><span class="bold">-s</span></td>
<td>  从每一信息包捕捉 <span class="italic">Snaplen</span> 字节的数据而非缺省的 80。80 字节对 IP、ICMP、TCP 和 UDP 而言已足够，但有可能截断名称服务器和 NFS 信息包的协议信息（参见下面）。信息包因为有限的快照以“[|<span class="italic">proto</span>]”表示在输出中而被截断，其中 <span class="italic">proto</span> 是发生截断的协议层的名称。
<p></p><blockquote><span class="bold">注：</span>获取更大的快照会增加它处理信息包的时间，并因此减少包缓冲的量。这可能会造成信息包的丢失。应限制捕捉所感兴趣的协议信息的 <span class="italic">Snaplen</span> 到最小字节数。</blockquote></td>
</tr>
<tr>
<td>
<a id="pgxui394kbar" name="pgxui394kbar"></a><span class="bold">-S</span></td>
<td>  打印绝对而非相对的 TCP 序列号。</td>
</tr>
<tr>
<td>
<a id="mgxui192kbar" name="mgxui192kbar"></a><span class="bold">-t</span></td>
<td>  省略在每一转储行打印一个时间戳。</td>
</tr>
<tr>
<td>
<a id="d306db1510harr" name="d306db1510harr"></a><span class="bold">-tt</span></td>
<td>  在每一转储行打印一个未格式化的时间戳。</td>
</tr>
<tr>
<td>
<a id="dhxui3b9kbar" name="dhxui3b9kbar"></a><span class="bold">-v</span></td>
<td>  指定稍微详细些的输出。例如，打印 IP 信息包的生存时间和服务信息的类型。</td>
</tr>
<tr>
<td>
<a id="rhxui1fbkbar" name="rhxui1fbkbar"></a><span class="bold">-w</span></td>
<td>  将原始的信息包写入 <span class="italic">File</span> 而不是分析和打印它们。它们可以在以后用 <span class="bold">-r</span> 标志打印出来。如果&nbsp;<span class="italic">File</span> 为“-”，则使用标准输出。</td>
</tr>
<tr>
<td>
<a id="shxuicckbar" name="shxuicckbar"></a><span class="bold">-x</span></td>
<td>  以十六制打印每一个包（减去其链接层头）。将打印出整个包或 <span class="italic">Snaplen</span> 字节中的较小者。</td>
</tr>
</tbody>
</table>
<a name="d306db2068harr"></a>
<h3 id="d306db2068harr">示例</h3>
<ol type="1">
<li><a name="d306db2212harr"></a><span id="d306db2212harr" class="pk"></span>要打印所有到达或离开 <tt>devo</tt> 的信息包：
<p></p>
<a name="d306db2334harr"></a>
<pre id="d306db2334harr" class="xmp">tcpdump host devo</pre></li>
<li><a name="d306db2506harr"></a><span id="d306db2506harr" class="pk"></span>要打印在 <tt>gil</tt> 和 <tt>devo</tt> 或 <tt>bevo</tt> 之间的流量：
<p></p>
<a name="d306db2665harr"></a>
<pre id="d306db2665harr" class="xmp">tcpdump ip host gil and \(devo bevo\)</pre></li>
<li><a name="d306db2787harr"></a><span id="d306db2787harr" class="pk"></span>要打印 <tt>bevo</tt> 和除了 <tt>gil</tt> 以外的任一主机间的所有 IP 信息包：
<p></p>
<a name="d306db2962harr"></a>
<pre id="d306db2962harr" class="xmp">tcpdump ip host bevo and bevo gil</pre></li>
<li><a name="d306db3101harr"></a><span id="d306db3101harr" class="pk"></span>要打印在本地主机和网络 <tt>192.100.192</tt> 上的主机间的所有流量：
<p></p>
<a name="d306db3265harr"></a>
<pre id="d306db3265harr" class="xmp">tcpdump net 192.100.192</pre></li>
<li><a name="d306db3427harr"></a><span id="d306db3427harr" class="pk"></span>要打印既非源自也非去往本地主机的流量：
<p></p>
<a name="d306db3604harr"></a>
<pre id="d306db3604harr" class="xmp">tcpdump ip and not net localnet</pre></li>
<li><a name="d306db3747harr"></a><span id="d306db3747harr" class="pk"></span>要打印每一个包括一个非本地主机的 TCP 对话的开始和结束信息包（SYN和 FIN 包）：
<p></p>
<a name="d306db3905harr"></a>
<pre id="d306db3905harr" class="xmp">tcpdump \(tcp[13] \&amp; 3 !=0 and not src and dst net localnet\)</pre></li>
<li><a name="d306db4079harr"></a><span id="d306db4079harr" class="pk"></span>要打印所有非 echo 请求或答复的 ICMP 信息包（非 ping 信息包）：
<p></p>
<a name="d306db4281harr"></a>
<pre id="d306db4281harr" class="xmp">tcpdump \(icmp[0] !=8 and icmp[0] !=0\)</pre></li>
<li><a name="d306db4445harr"></a><span id="d306db4445harr" class="pk"></span>要直接打印包信息，输入：
<p></p>
<a name="d306db4549harr"></a>
<pre id="d306db4549harr" class="xmp">tcpdump -I</pre></li>
<li><a name="d306db4688harr"></a><span id="d306db4688harr" class="pk"></span>要指定令牌环接口来侦听，输入：
<p></p>
<a name="d306db4808harr"></a>
<pre id="d306db4808harr" class="xmp">tcpdump -i tr0</pre></li>
<li><a name="d306db4963harr"></a><span id="d306db4963harr" class="pk"></span>要打印包信息到文件<span class="italic"> TraceInfo</span>，输入：
<p></p>
<a name="d306db5097harr"></a>
<pre id="d306db5097harr" class="xmp">tcpdump -wTraceInfo</pre></li></ol>
<FONT COLOR="#A62A2A"></FONT><p></p>
   <center>
<B>[ <a href="tcpdump.htm#Top_Of_Page">页的顶部</a> | <a href="tcopy.htm">上一页</a> | <a href="tctl.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> | <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>

<a id="Bot_Of_Page" name="Bot_Of_Page"></a>
</body>
</html>
