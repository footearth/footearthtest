<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>命令参考大全，卷 5，s - u - trace 守护进程</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="dc.date" scheme="iso8601" content="2004-04-30" />
<meta name="copyright" content="(C) IBM公司版权 1997, 2004" />
<meta name="security" content="public" />
<meta name="dc.language" scheme="rfc1766" content="zh-cn" />
<meta name="Robots" content="index,follow"/>
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="owner" content="" />
<link rel="stylesheet" type="text/css" href="ibmidwb.css" />
<link rel="stylesheet" type="text/css" href="text.css" />
</head>
<body>
<a id="Top_Of_Page" name="Top_Of_Page"></a> <P><center>
<B>[ <a href="trace.htm#Bot_Of_Page">页的底部</a> | <a href="tr.htm">上一页</a> | <a href="traceroute.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> |  <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>
<center><h1>命令参考大全，卷 5，s - u</h1></center>

<a name="a236y977a8"></a>
<h2 id="a236y977a8">trace 守护进程</h2>
<a name="a236y977aa"></a>
<h3 id="a236y977aa">用途</h3>
<p>记录选定的系统事件。</p>
<a name="wq1091"></a>
<h3 id="wq1091">语法</h3>
<p><span class="bold">Trace</span> [&nbsp;<span class="bold"> <a href="trace.htm#a5gz360jess">-a&nbsp;</a></span>[&nbsp;<span class="bold"> <a href="trace.htm#c1cee5d324jeff">-g&nbsp;</a></span>]&nbsp;] [&nbsp;<span class="bold"> <a href="trace.htm#igz300jess">-f&nbsp;</a></span>|&nbsp;<span class="bold"> <a href="trace.htm#fiz2c0jess">-l&nbsp;</a></span>] [ <a href="trace.htm#i098840tmh3"><span class="bold">-b</span></a>&nbsp;|&nbsp;  <a href="trace.htm#i098840tmh4"><span class="bold">-B</span></a>] [<span class="bold"> <a href="trace.htm#rgdoh3dmanu">-c</a></span>] [  <a href="trace.htm#uppercflag"><span class="bold">-C</span></a> [  <span class="italic">CPUList</span> | <span class="bold">all</span> ]] [&nbsp;<span class="bold"> <a href="trace.htm#tgz1e0jess">-d&nbsp;</a></span>] [&nbsp;<span class="bold"> <a href="trace.htm#a3hz300jess">-h&nbsp;</a></span>] [<span class="bold"> <a href="trace.htm#a5ndok3b5borg">-j&nbsp;</a></span><span class="italic">Event&nbsp;</span>[&nbsp;<span class="italic">、Event&nbsp;</span>]&nbsp;]
[<span class="bold"> <a href="trace.htm#tracekflag">-k&nbsp;</a></span><span class="italic">Event&nbsp;</span>[&nbsp;<span class="bold">、</span><span class="italic">Event&nbsp;</span>]&nbsp;] [ <a href="trace.htm#tracecapjflag"><span class="bold">-J</span></a> <span class="italic">Event-group</span> [，<span class="italic">Event-grou</span> ]]
[ <a href="trace.htm#tracecapkflag"><span class="bold">-K</span></a> <span class="italic">Event-grou</span> [，<span class="italic">Event-grou</span> ]] [&nbsp;<span class="bold"> <a href="trace.htm#viz2c0jess">-m&nbsp;</a></span><span class="italic">Message&nbsp;</span>] &nbsp;[&nbsp;<span class="bold"> <a href="trace.htm#a4logi1c8manu">-n&nbsp;</a></span>] [&nbsp;<span class="bold"> <a href="trace.htm#wjz80jess">-o</a></span><span class="italic">&nbsp;Name&nbsp;</span>]
[&nbsp;<span class="bold"> <a href="trace.htm#qjzjess">-o-&nbsp;</a></span>] [&nbsp;<span class="bold"> <a href="trace.htm#qjzjessjs">-p</a>&nbsp;</span>] [&nbsp;<span class="bold"> <a href="trace.htm#gkz40jess">-s&nbsp;</a></span>] [&nbsp;<span class="bold"> <a href="trace.htm#xkz240jess">-L</a></span><span class="italic">&nbsp;Size&nbsp;</span>] [&nbsp;<span class="bold"> <a href="trace.htm#okz360jess">-T</a></span><span class="italic">&nbsp;Size&nbsp;</span>]</p>
<a name="a236y977ae"></a>
<h3 id="a236y977ae">描述</h3>
<p><span class="bold">trace</span> 守护进程配置一个跟踪会话，并启动系统事件的收集。跟踪功能所收集的数据记录在跟踪日志中。跟踪日志的报告可以用 <span class="bold">trcrpt</span> 命令生成。</p>
<p>当用 <span class="bold"> <a href="trace.htm#a5gz360jess">-a</a></span> 标志调用时，trace 守护进程就异步运行（即作为一个后台任务）。否则，它就会交互式地运行，并提示您输入<a href="trace.htm#a236y977b1">子命令</a>。</p>
<p>可以使用系统管理接口工具（SMIT）来运行 <span class="bold">trace</span> 守护进程。要使用 SMIT，请输入：</p>
<p></p>
<a name="c467269c9borg"></a>
<pre id="c467269c9borg" class="xmp">smit trace</pre>
<p>共有以下三种跟踪数据收集的方式：</p>
<a name="wq1092"></a>
<table id="wq1092" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="40%">
<a id="c46730dc9borg" name="c46730dc9borg"></a><span class="bold">备用</span>（缺省值）</td>
<td width="60%">所有的跟踪事件都在跟踪日志文件中捕获。</td>
</tr>
<tr>
<td><span class="bold">循环</span> (<span class="bold"> <a href="trace.htm#fiz2c0jess">-l</a></span>)</td>
<td>跟踪事件包括在内存缓冲区中，不在跟踪日志文件中捕获，直到跟踪数据收集工作停止为止。</td>
</tr>
<tr>
<td><span class="bold">单一</span> (<span class="bold"> <a href="trace.htm#igz300jess">-f</a></span>)</td>
<td>当内存跟踪缓冲区已满，且缓冲区中的内容已捕获在跟踪日志文件中时，跟踪事件的收集工作就结束。</td>
</tr>
<tr>
<td><span class="bold">缓冲区分配</span></td>
<td>跟踪缓冲区可以从内核堆分配，或放入独立的段中。缺省情况下，除非请求的缓冲区大小很大以致不能装入内核堆（这种情况下，则在独立的段中分配缓冲区），否则缓冲区一律都从内核堆中分配。从独立的段分配缓冲区，多少有点妨碍跟踪性能。但是，独立段中的缓冲区不会占用调页空间，只占一点锁定内存。缓冲区分配的类型可以用可选的 <span class="bold">-b</span> 或 <span class="bold">-B</span> 标志来指定。</td>
</tr>
</tbody>
</table>
<a name="a236y977b0"></a>
<h3 id="a236y977b0">标志</h3>
<p></p>
<a name="wq1093"></a>
<table id="wq1093" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="35%">
<a id="a5gz360jess" name="a5gz360jess"></a><span class="bold">-a</span></td>
<td width="65%">异步运行 <span class="bold">trace</span> 守护进程（即作为一个后台任务）。一旦以此种方式启动 <span class="bold">trace</span>，则可以使用 <span class="bold">trcon</span>、<span class="bold">trcoff</span> 和 <span class="bold">trcstop</span> 命令来分别启动跟踪、停止跟踪或退出跟踪会话。这些命令可以作为链接到 <span class="bold">trace</span> 的链路来实现。</td>
</tr>
<tr>
<td>
<a id="i098840tmh3" name="i098840tmh3"></a><span class="bold">-b</span></td>
<td>从内核堆分配缓冲区。如果不能从内核堆获取所请求的缓冲区空间，则命令失败。
<a name="wq1094"></a>
<div class="notetitle" id="wq1094">注:</div>
<div class="notebody"><span class="bold">-b</span> 标志只对 32 位内核有效。</div></td>
</tr>
<tr>
<td>
<a id="i098840tmh4" name="i098840tmh4"></a><span class="bold">-B</span></td>
<td>在独立段中分配缓冲区。
<a name="wq1095"></a>
<div class="notetitle" id="wq1095">注:</div>
<div class="notebody"><span class="bold">-B</span> 标志只对 32 位内核有效。</div></td>
</tr>
<tr>
<td>
<a id="rgdoh3dmanu" name="rgdoh3dmanu"></a><span class="bold">-c</span></td>
<td>保存跟踪日志文件，添加 <span class="bold">.old</span> 到其文件名。</td>
</tr>
<tr>
<td>
<a id="uppercflag" name="uppercflag"></a><span class="bold">-C</span> [ <span class="italic">CPUList</span> | <span class="bold">all</span> ]</td>
<td>使用一个缓冲区集合跟踪 <span class="italic">CPUList</span> 中的每个 CPU。多个 CPU 可以用逗号隔开，或包含在双引号中然后用逗号或空格隔开。要跟踪所有 CPU，请指定 <span class="bold">all</span>。因为该标志对每个 CPU 使用了一个缓冲区集合并为每个 CPU 生成一个文件，所以它可能消耗大量内存和文件空间，因此应该小心使用。产生的文件名为 <span class="bold">trcfile</span>、<span class="bold">trcfile-0</span> 和 <span class="bold">trcfile-1</span> 等，其中 <span class="bold">0</span>、<span class="bold">1</span> 等是 CPU 编号。如果指定了 <span class="bold">-T</span> 或 <span class="bold">-L</span>，则大小适用于每一个缓冲区集合和每一个文件。对于单处理机系统，可以指定 <tt>-C all</tt>，但是带有 CPU 编号列表的 <tt>-C</tt> 将被忽略。如果 <span class="bold">-C</span> 用于指定多个 CPU，如 <tt>-Call</tt> 或 <tt>-C "0 1"</tt>，则相关的缓冲区不放入系统转储中。
<div class="attention"><span class="attentiontitle">注意: </span> 只有 root 用户才能使用 -C 标志。</div></td>
</tr>
<tr>
<td>
<a id="tgz1e0jess" name="tgz1e0jess"></a><span class="bold">-d</span></td>
<td>禁用自动启动跟踪数据收集。延时启动跟踪数据收集。正常情况下，每当开始 <span class="bold">trace</span> 守护进程时，就会自动启动跟踪数据收集。使用 <span class="bold">trcon</span> 命令来启动跟踪数据收集。</td>
</tr>
<tr>
<td>
<a id="igz300jess" name="igz300jess"></a><span class="bold">-f</span></td>
<td>以单一方式运行 <span class="bold">trace</span>。当内存缓冲区已满时，立即停止跟踪数据收集。然后将跟踪数据写入跟踪日志。使用 <span class="bold">trcon</span> 命令来重新启动跟踪数据收集，并捕获另一个已满的数据缓冲区。如果在缓冲区满之前发出 <span class="bold">trcoff</span> 子命令，就停止跟踪数据收集并将缓冲区当前内容写入跟踪日志。</td>
</tr>
<tr>
<td>
<a id="c1cee5d324jeff" name="c1cee5d324jeff"></a><span class="bold">-g</span></td>
<td>在一般跟踪通道（通道 1 至 7）中启动跟踪会话。该标志仅当 <span class="bold">trace</span> 异步运行（<span class="bold">-a</span>）时才有效。命令的返回码就是通道编号；通道编号随后必须用于一般跟踪子例程调用。要停止一般跟踪会话，可使用命令 <span class="bold">trcstop&nbsp;-&lt;</span>channel_number>。</td>
</tr>
<tr>
<td>
<a id="a3hz300jess" name="a3hz300jess"></a><span class="bold">-h</span></td>
<td>省略跟踪日志的头记录。正常情况下，<span class="bold">trace</span> 守护进程在跟踪日志开始部位写头记录：日期和时间（通过 <span class="bold">date</span> 命令）、系统名称、版本和发行版、节点标识、机器标识（通过 <span class="bold">uname -a</span> 命令）以及用户定义的消息。在跟踪日志开始部位，头记录的信息包括在 <span class="bold">trcrpt</span> 命令的输出中。</td>
</tr>
<tr>
<td>
<a id="a5ndok3b5borg" name="a5ndok3b5borg"></a><span class="bold">-j</span><span class="italic"> Event</span>[<span class="bold">、</span><span class="italic">Event</span>]</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>
<a id="tracekflag" name="tracekflag"></a><span class="bold">-k</span><span class="italic"> Event</span>[<span class="bold">,</span><span class="italic">Event</span>]</td>
<td>指定您想要收集（<span class="bold">-j</span>）或排除（<span class="bold">-k</span>）其跟踪数据的用户定义事件。<span class="italic">Event</span> 列表项可以用逗号隔开，或包含在双引号中并用逗号或空格隔开。
<p></p><blockquote>
<a name="c46738cc9borg"></a>
<p id="c46738cc9borg"><span class="bold">注：</span>以下事件用于确定 <span class="bold">trcrpt</span> 报告中的 pid、cpuid 和 exec 路径名称：</p> 
<p></p>
<a name="a182c175"></a>
<pre id="a182c175" class="xmp">106 分派
10C 分派空闲进程
134 EXEC 系统调用
139 FORK 系统调用
465 KTHREAD 创建</pre> 
<a name="c4673e4c9borg"></a>
<p id="c4673e4c9borg">如果这些事件中有任一事件丢失，则 <span class="bold">trcrpt</span> 命令所报告的信息就不完整。因此：当使用 <span class="bold">-j</span> 标志时，应该包括 <span class="italic">Event</span> 列表中的所有这些事件；相反，当使用 <span class="bold">-k</span> 标志时，则不应该包括 <span class="italic">Event</span> 列表中的这些事件。如果用 SMIT 或 -J 标志启动跟踪，则这些事件就在 <span class="bold">tidhk</span> 组中。</p></blockquote></td>
</tr>
<tr>
<td>
<a id="tracecapjflag" name="tracecapjflag"></a><span class="bold">-J</span> <span class="italic">Event-group</span> [<span class="bold">, </span><span class="italic">Event-group</span>
]</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>
<a id="tracecapkflag" name="tracecapkflag"></a><span class="bold">-K</span> <span class="italic">Event-group</span> [ <span class="bold">,</span><span class="italic">Event-group</span>]</td>
<td> 指定要被包含（<span class="bold">-J</span>）或排除（<span class="bold">-K</span>）的事件组。事件组在“调试和性能跟踪”中描述。<span class="bold">-J</span> 和 <span class="bold">-K</span> 标志除了有事件组而不是个别 hook 标识以外，其它方面均同 <span class="bold">-j</span> 和 <span class="bold">-k</span> 作用相似。可以指定所有四个标志 <span class="bold">-j</span>、<span class="bold">-J</span>、<span class="bold">-k</span> 和 <span class="bold">-K</span>。</td>
</tr>
<tr>
<td>
<a id="fiz2c0jess" name="fiz2c0jess"></a><span class="bold">-l</span></td>
<td>以循环方式运行 <span class="bold">trace</span>。在停止跟踪数据收集时，<span class="bold">trace</span> 守护进程将跟踪数据写入跟踪日志中。仅捕获跟踪数据的最后一个缓冲区。使用 <span class="bold">trcoff</span> 命令来停止跟踪数据收集时，应该使用 <span class="bold">trcon</span> 命令来重新启动它。</td>
</tr>
<tr>
<td>
<a id="xkz240jess" name="xkz240jess"></a><span class="bold">-L</span><span class="italic"> Size</span></td>
<td>用所规定的值来重设缺省跟踪日志文件 1 MB的大小。将文件大小指定为 0，便将跟踪日志文件大小设置为缺省值。
<p></p><blockquote><span class="bold">注：</span>在循环方式和备用方式中，跟踪日志文件大小必须至少是跟踪缓冲区大小的两倍。在单一方式中，跟踪日志文件必须至少是缓冲区的大小。有关控制跟踪缓冲区大小的信息，请参阅 <span class="bold">-T</span> 标志。</blockquote></td>
</tr>
<tr>
<td>
<a id="viz2c0jess" name="viz2c0jess"></a><span class="bold">-m</span><span class="italic"> Message</span></td>
<td>指定将要包括在跟踪日志的消息字段头记录中的文本。</td>
</tr>
<tr>
<td>
<a id="a4logi1c8manu" name="a4logi1c8manu"></a><span class="bold">-n</span></td>
<td>将这些信息添加到跟踪日志头：锁定信息、硬件信息以及对于每一个装入程序项的符号名称、地址和类型。</td>
</tr>
<tr>
<td>
<a id="wjz80jess" name="wjz80jess"></a><span class="bold">-o</span><span class="italic"> Name</span></td>
<td>重设 <span class="bold">/var/adm/ras/trcfile</span> 缺省跟踪日志文件并将跟踪数据写入用户定义的文件。</td>
</tr>
<tr>
<td>
<a id="qjzjess" name="qjzjess"></a><span class="bold">-o -</span></td>
<td>重设缺省跟踪日志名称，并将跟踪数据写入标准输出。当使用此标志时，<span class="bold"> <a href="trace.htm#rgdoh3dmanu">-c</a></span> 标志被忽略。如果指定 <span class="bold">-o-</span> 和 <span class="bold">-C</span>，则会产生一个错误。</td>
</tr>
<tr>
<td>
<a id="qjzjessjs" name="qjzjessjs"></a><span class="bold">-p</span></td>
<td>每一个 hook 都包含当前处理器的 cpuid。该标志仅对 64 位内核跟踪有效。
<p></p><blockquote><span class="bold">注：</span><span class="bold">trcrpt</span> 命令会向 cpuid 报告是否指定了该选项。</blockquote></td>
</tr>
<tr>
<td>
<a id="gkz40jess" name="gkz40jess"></a><span class="bold">-s</span></td>
<td>当填写跟踪日志时，停止跟踪。当跟踪日志填满后，通常<span class="bold">trace</span> 守护进程都回绕跟踪日志，并继续收集跟踪数据。在异步操作过程中，该标志可以使 <span class="bold">trace</span> 守护进程停止跟踪数据收集。（在交互式操作中，必须用 <span class="bold">quit</span> 子命令来停止跟踪。）</td>
</tr>
<tr>
<td>
<a id="okz360jess" name="okz360jess"></a><span class="bold">-T</span><span class="italic"> Size</span></td>
<td>
<p>用所规定的值重设缺省跟踪缓冲区 128 KB 的大小。必须以 root 用户来请求 1 MB 以上的缓冲区空间。最大可能的大小为 268435184 字节，除非使用 <span class="bold">-f</span> 标志（此时大小为 536870368 字节）。最小可能的大小为 8192 字节，除非使用 <span class="bold">-f</span> 标志（此时大小为 16392 字节）。当使用 <span class="bold">-f</span> 标志时，8192 和 16392 之间的大小都可使用；但是实际使用的大小为 16392 字节。</p><blockquote><span class="bold">注：</span>在循环方式和备用方式中，跟踪缓冲区的大小必须是跟踪日志文件大小的一半，或小于跟踪日志文件大小。在单一方式中，跟踪日志文件必须至少是缓冲区的大小。有关控制跟踪日志文件大小的信息，请参阅 <span class="bold">-L</span> 标志。另外也请注意，跟踪缓冲区使用锁定内存，这意味着它们不可页面调度。因此，跟踪缓冲区越大，就有越少的物理内存适用于应用程序。
<p>除非指定 <span class="bold">-b</span> 或 <span class="bold">-B</span> 标志，否则系统都会试图从内核堆分配缓冲区空间。如果该请求不能得到满足，则系统会试图将缓冲区作为独立段来分配。</p></blockquote>
<p><span class="bold">-f</span> 标志实际上使用了两个缓冲区，它们一起作为单个缓冲区来运行（除了当第一个缓冲区满时，将记录一个缓冲区回绕跟踪 hook 这种情况以外）。</p></td>
</tr>
</tbody>
</table>
<a name="a236y977b1"></a>
<h3 id="a236y977b1">子命令</h3>
<a name="c46744ec9borg"></a>
<p id="c46744ec9borg">当以交互方式运行时，跟踪会识别以下一些子命令：</p>
<a name="wq1096"></a>
<table id="wq1096" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="16%">
<a id="a26891685" name="a26891685"></a><span class="bold">trcon</span></td>
<td width="83%">启动跟踪数据收集。</td>
</tr>
<tr>
<td>
<a id="a26891686" name="a26891686"></a><span class="bold">trcoff</span></td>
<td>停止跟踪数据收集。</td>
</tr>
<tr>
<td>
<a id="a26891687" name="a26891687"></a><span class="bold">q</span> 或 <span class="bold">quit</span></td>
<td>停止跟踪数据收集并退出 <span class="bold">trace</span>。</td>
</tr>
<tr>
<td>
<a id="a26891688" name="a26891688"></a><span class="bold">!</span><span class="italic"> Command</span></td>
<td>运行由 <span class="italic">Command</span> 参数指定的 shell 命令。</td>
</tr>
<tr>
<td>
<a id="a2789c3a" name="a2789c3a"></a><span class="bold">?</span></td>
<td>显示 <span class="bold">trace</span> 子命令摘要。</td>
</tr>
</tbody>
</table>
<a name="a236y977b2"></a>
<h3 id="a236y977b2">信号</h3>
<a name="c4674c9c9borg"></a>
<p id="c4674c9c9borg"><span class="bold">INTERRUPT</span> 信号充当启动和停止跟踪数据收集的开关。中断被设置为 <span class="bold">SIG_IGN</span> 用于被跟踪的进程。</p>
<a name="a236y977b3"></a>
<h3 id="a236y977b3">示例</h3>
<ol type="1">
<li>若要以交互方式使用跟踪，请输入 <tt>trace</tt>（此时将显示 <tt>></tt> 提示符），然后指定所需的<a href="trace.htm#a236y977b1">子命令</a>。例如，要在运行 <span class="italic">anycmd</span> 命令期间跟踪系统事件，请输入：
<p></p>
<a name="a236y97783"></a>
<pre id="a236y97783" class="xmp">trace
> !anycmd
> q</pre></li>
<li>要避免在命令完成时发生延时，可以只使用一个命令行异步启动跟踪（<span class="bold"> <a href="trace.htm#a5gz360jess">-a</a></span>）。输入：
<p></p>
<a name="a2789c3e"></a>
<pre id="a2789c3e" class="xmp">trace -a; anycmd; trcstop</pre></li>
<li>要跟踪系统本身 10 秒左右，请输入：
<p></p>
<a name="d936819599jani"></a>
<pre id="d936819599jani" class="xmp">trace -a; sleep 10; trcstop</pre></li>
<li>要输出跟踪数据到特定的跟踪日志文件（而不是 <span class="bold">/var/adm/ras/trcfile</span> 缺省跟踪日志文件），请输入：
<p></p>
<a name="c46756ac9borg"></a>
<pre id="c46756ac9borg" class="xmp">trace -a -o /tmp/my_trace_log; anycmd; trcstop</pre></li>
<li>要捕获 <span class="bold">cp</span> 命令的执行，从收集进程排除特殊事件，请输入：
<p></p>
<a name="c4685e7c9borg"></a>
<pre id="c4685e7c9borg" class="xmp">trace -a -k 『20e,20f』; cp /bin/track /tmp/junk; trcstop</pre> 
<p>在上例中，<span class="bold"> <a href="trace.htm#a5ndok3b5borg">-k</a></span> 选项抑制从 <span class="bold">lockl</span> 和 <span class="bold">unlockl</span> 函数收集事件（20e 和 20f 事件）。</p></li>
<li>要跟踪 hook 234 以及能使用户可以看到进程名称的 hook，请使用：
<p></p>
<pre class="xmp">trace -a -j 234 -J tidhk</pre>这可以跟踪事件组“tidhk”中的 hook 和 hook 234。</li>
<li>要使跟踪对每个 CPU 使用一个缓冲区集合，请指定：
<p></p>
<pre class="xmp">trace -aC all</pre> 
<p>产生的文件为 <span class="bold">/var/adm/ras/trcfile</span>、 <span class="bold">/var/adm/ras/trcfile-0</span>、<span class="bold">/var/adm/ras/trcfile-1</span> 等等，直至 <span class="bold">/var/adm/ras/trcfile-</span>(<span class="italic">n</span>-1)，其中 <span class="italic">n</span> 为系统中 CPU 的数目。</p>
<a name="wq1098"></a>
<div class="notetitle" id="wq1098">注:</div>
<div class="notebody"><tt>trace -aCall -o mylog</tt> 产生文件 mylog-0、mylog-1、...</div></li></ol>
<a name="a236y977bb"></a>
<h3 id="a236y977bb">文件</h3>
<p></p>
<a name="wq1099"></a>
<table id="wq1099" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="46%">
<a id="a9db529b266dian" name="a9db529b266dian"></a><span class="bold">/usr/include/sys/trcmacros.h</span></td>
<td width="53%">定义 <span class="bold">trchook</span> 和 <span class="bold">utrchook</span> 宏。</td>
</tr>
<tr>
<td>
<a id="a39c3b25519janb" name="a39c3b25519janb"></a><span class="bold">/var/adm/ras/trcfile</span></td>
<td>包括缺省跟踪日志文件。</td>
</tr>
</tbody>
</table>
<a name="a236y977be"></a>
<h3 id="a236y977be">相关信息</h3>
<p><span class="bold">trcevgrp</span> 命令、<span class="bold"><a href="trcnm.htm#mokni2abill">trcnm</a></span> 命令、<span class="bold"><a href="trcrpt.htm#a265911a9">trcrpt</a></span> 命令、<span class="bold"><a href="trcstop.htm#a26591143">trcstop</a></span> 命令。</p>
<p><span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trchook.htm#bog1f0kevi">trchook</a></span> 子例程、<span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trcgen.htm#a3129604">trcgen</a></span> 子例程、<span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trcstart.htm#a284978">trcstart</a></span> 子例程、<span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trcon.htm#a3119e42">trcon</a></span> 子例程、<span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trcoff.htm#a28497b">trcoff</a></span> 子例程、<span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/basetrf2/trcstop.htm#bi1240thri">trcstop</a></span> 子例程。</p>
<p><span class="bold"><a href="http://study.chyangwa.com/IT/AIX/aixcmds5/libs/ktechrf1/trcgenk.htm#v9f360nick">trcgenk</a></span> 内核服务。</p>
<p><span class="italic">AIX 5L Version 5.2 General Programming Concepts: Writing and Debugging Programs</span> 中的 <a href="http://study.chyangwa.com/IT/AIX/aixcmds5/aixprggd/genprogc/trace_facility.htm#yg3100thri">Trace Facility Overview</a>。</p>
<p><span class="italic">《AIX 5L V5.2 性能管理指南》</span>中的<a href="http://study.chyangwa.com/IT/AIX/aixcmds5/aixbman/prftungd/tracefacility.htm">『用跟踪工具进行性能分析』</a>。</p>
<p><span class="italic">AIX 5L Version 5.2 Kernel Extensions and Device Support Programming Concepts</span> 中的 Debug and Performance Tracing。</p>
<FONT COLOR="#A62A2A"></FONT><p></p>
   <center>
<B>[ <a href="trace.htm#Top_Of_Page">页的顶部</a> | <a href="tr.htm">上一页</a> | <a href="traceroute.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> | <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>

<a id="Bot_Of_Page" name="Bot_Of_Page"></a>
</body>
</html>
