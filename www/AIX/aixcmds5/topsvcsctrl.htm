<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>命令参考大全，卷 5，s - u - topsvcsctrl 命令</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="dc.date" scheme="iso8601" content="2004-04-30" />
<meta name="copyright" content="(C) IBM公司版权 1997, 2004" />
<meta name="security" content="public" />
<meta name="dc.language" scheme="rfc1766" content="zh-cn" />
<meta name="Robots" content="index,follow"/>
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="owner" content="" />
<meta name="keywords" content="topsvcsctrl 脚本, topsvcsctrl, 脚本, 控制脚本,
拓扑服务子系统, 可靠的可伸缩群集技术（RSCT）拓扑服务, RSCT 拓扑服务" />
<link rel="stylesheet" type="text/css" href="ibmidwb.css" />
<link rel="stylesheet" type="text/css" href="text.css" />
</head>
<body>
<a id="Top_Of_Page" name="Top_Of_Page"></a> <P><center>
<B>[ <a href="topsvcsctrl.htm#Bot_Of_Page">页的底部</a> | <a href="topsvcs.htm">上一页</a> | <a href="touch.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> |  <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>
<center><h1>命令参考大全，卷 5，s - u</h1></center>

<a name="topsvcsctrl"></a>
<h2 id="topsvcsctrl">topsvcsctrl 命令</h2>
<a name="wq1015"></a>
<h3 id="wq1015">用途</h3>
<p>启动拓扑服务子系统。</p><a id="idx474" name="idx474"></a><a id="idx475" name="idx475"></a><a id="idx476" name="idx476"></a><a id="idx477" name="idx477"></a><a id="idx478" name="idx478"></a><a id="idx479" name="idx479"></a>
<a name="wq1016"></a>
<h3 id="wq1016">语法</h3>
<p><span class="pk">topsvcsctrl</span> { <a href="topsvcsctrl.htm#topsvcsctrl_flag_a"><span class="pk">-a</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_s"><span class="pk">-s</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_k"><span class="pk">-k</span></a> |  <a href="topsvcsctrl.htm#topsvcsctrl_flag_d"><span class="pk">-d</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_c"><span class="pk">-c</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_u"><span class="pk">-u</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_t"><span class="pk">-t</span></a> |  <a href="topsvcsctrl.htm#topsvcsctrl_flag_o"><span class="pk">-o</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_r"><span class="pk">-r</span></a> | <a href="topsvcsctrl.htm#topsvcsctrl_flag_h"><span class="pk">-h</span></a> }</p>
<a name="wq1017"></a>
<h3 id="wq1017">描述</h3>
<p><span class="pk">topsvcsctrl</span> 控制脚本控制拓扑服务子系统的运行。此子系统由系统资源控制器（SRC）进行控制，并属于一个称为 <span class="pk">topsvcs</span> 的子系统组。此脚本通常由 HACMP/ES 启动进程来启动。</p>
<p>拓扑服务子系统的一个实例运行在群集的每一个节点上。</p>
<p>从操作观点来看，拓扑服务子系统组采取如下组织：</p>
<dl>
<dt class="bold">子系统</dt>
<dd>拓扑服务
</dd>
<dt class="bold">子系统组</dt>
<dd><span class="pk">topsvcs</span>
</dd>
<dt class="bold">SRC 子系统</dt>
<dd><span class="pk">topsvcs</span> 
<p><span class="pk">topsvcs</span> 子系统与 <span class="pk">hatsd</span> 守护进程和 <span class="pk">topsvcs</span> 脚本关联。<span class="pk">topsvcs</span> 脚本配置并启动 <span class="pk">hatsd</span> 守护进程。节点上的子系统名为 <span class="pk">topsvcs</span>。每个节点都有一个子系统并与节点所属的群集关联。</p>
</dd>
<dt class="bold">守护进程</dt>
<dd><span class="pk">hatsd</span> 
<p>提供拓扑服务。<span class="pk">topsvcs</span> 脚本配置并启动 <span class="pk">hatsd</span> 守护进程。</p>
</dd>
</dl>
<p><span class="pk">topsvcsctrl</span> 脚本通常不能从命令行执行。它通常被 HACMP/ES 启动命令调用。</p>
<p><span class="pk">topsvcsctrl</span> 脚本提供了多种拓扑服务子系统的操作控制：</p>
<ul>
<li>添加、启动、停止和删除子系统</li>
<li>清除子系统，即从所有系统分区将其删除</li>
<li>打开和关闭跟踪功能</li>
<li>刷新子系统</li></ul><p class="indatacontent"> 在执行任一这些功能之前，脚本获取当前群集名（使用 <span class="pk">cllsclstr</span> 命令）和节点号（使用 <span class="pk">clhandle</span> 命令）。如果节点号为 <span class="pk">0</span>，控制脚本就在控制工作站上运行。</p>
<p>除了清除与取消配置这两个功能，其余功能都可在当前系统分区作用域内执行。</p>
<p><span class="bold">添加子系统：</span>如果指定了 <span class="pk">-a</span> <span>标志</span>，此控制命令将使用 <span class="pk">mkssys</span> 命令把该拓扑服务子系统添加到 SRC。控制脚本操作如下：</p>
<ol type="1">
<li>确保 <span class="pk">topsvcs</span> 子系统已停止。</li>
<li>从 SRC 中除去 <span class="pk">topsvcs</span> 子系统（以防它仍在那儿）。</li>
<li>将 <span class="pk">topsvcs</span> 子系统添加到 SRC 中。</li></ol>
<p><span class="bold">启动子系统：</span>当指定 <span class="pk">-s</span> <span>标志</span>时，控制脚本使用 <span class="pk">startsrc</span> 命令来启动拓扑服务子系统 <span class="pk">topsvcs</span>。</p>
<p><span class="bold">停止子系统：</span>当指定 <span class="pk">-k</span> <span>标志</span>时，控制脚本使用 <span class="pk">stopsrc</span> 命令来停止拓扑服务子系统 <span class="pk">topsvcs</span>。</p>
<p><span class="bold">删除子系统：</span>当指定 <span class="pk">-d</span> <span>标志</span>时，控制脚本使用 <span class="pk">rmssys</span> 命令将拓扑服务子系统从 SRC 中除去。控制脚本操作如下：</p>
<ol type="1">
<li>确保 <span class="pk">topsvcs</span> 子系统已停止。</li>
<li>使用 <span class="pk">rmssys</span> 命令从 SRC 中除去 <span class="pk">topsvcs</span> 子系统。</li>
<li>从 <span class="pk">/etc/services</span> 文件中除去端口号。</li></ol>
<p><span class="bold">清除子系统：</span>当指定 <span class="pk">-c</span> <span>标志</span>时，控制脚本停止并从 SRC 的所有群集分区中除去拓扑服务子系统。控制脚本操作如下：</p>
<ol type="1">
<li>使用 <span class="pk">stopsrc -g topsvcs</span> 命令停止群集中子系统的所有实例。</li>
<li>从 <span class="pk">/etc/services</span> 文件中将 <span class="pk">topsvcs</span> 子系统的所有项都除去。</li></ol>
<p><span class="bold">打开跟踪功能：</span>当指定 <span class="pk">-t</span> <span>标志</span>时，控制脚本使用 <span class="pk">traceson</span> 命令为 <span class="pk">hatsd</span> 守护进程打开跟踪功能。</p>
<p><span class="bold">关闭跟踪功能：</span>当指定 <span class="pk">-o</span> <span>标志</span>，控制脚本使用 <span class="pk">tracesoff</span> 命令为 <span class="pk">hatsd</span> 守护进程关闭跟踪功能（返回其缺省级别）。</p>
<p><span class="bold">刷新子系统：</span>当指定 <span class="pk">-r</span> <span>标志</span>时，控制脚本使用 <span class="pk">topsvcs refresh</span> 命令和 <span class="pk">refresh</span> 命令刷新子系统。在全局对象数据管理器（ODM）中重建有关节点和适配器配置的信息，并给守护进程发信号去读取重建信息。</p>
<p><span class="bold">记录：</span>当拓扑服务守护进程（<span class="pk">hatsd</span>）运行时，它通过将项写入一个称为 <span class="pk">/var/ha/log/topsvcs</span><var class="pv">cluster_name</var> 的日志文件来提供有关其操作和错误的信息。</p>
<a name="wq1021"></a>
<h3 id="wq1021">标志</h3>
<a name="wq1022"></a>
<table id="wq1022" width="100%" summary="" border="0" frame="void" rules="all">
<tbody valign="top">
<tr>
<td width="13%">
<a id="topsvcsctrl_flag_a" name="topsvcsctrl_flag_a"></a><span class="pk">-a</span></td>
<td width="86%">添加子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_s" name="topsvcsctrl_flag_s"></a><span class="pk">-s</span></td>
<td>启动子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_k" name="topsvcsctrl_flag_k"></a><span class="pk">-k</span></td>
<td>停止子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_d" name="topsvcsctrl_flag_d"></a><span class="pk">-d</span></td>
<td>删除子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_c" name="topsvcsctrl_flag_c"></a><span class="pk">-c</span></td>
<td>清除子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_u" name="topsvcsctrl_flag_u"></a><span class="pk">-u</span></td>
<td>从所有分区删除此拓扑服务子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_t" name="topsvcsctrl_flag_t"></a><span class="pk">-t</span></td>
<td>打开子系统跟踪功能。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_o" name="topsvcsctrl_flag_o"></a><span class="pk">-o</span></td>
<td>关闭子系统跟踪功能。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_r" name="topsvcsctrl_flag_r"></a><span class="pk"> -r </span></td>
<td>刷新子系统。</td>
</tr>
<tr>
<td>
<a id="topsvcsctrl_flag_h" name="topsvcsctrl_flag_h"></a><span class="pk">-h</span></td>
<td>将脚本的用法语句写入标准输出。</td>
</tr>
</tbody>
</table>
<a name="wq1023"></a>
<h3 id="wq1023">安全性</h3>
<p>必须拥有有效的 <span class="pk">root</span> 用户标识才能使用此脚本。</p>
<a name="wq1024"></a>
<h3 id="wq1024">退出状态</h3>
<dl>
<dt class="bold">0</dt>
<dd>指示脚本成功完成。
</dd>
<dt class="bold">1</dt>
<dd>表明有错误发生。
</dd>
</dl>
<a name="wq1025"></a>
<h3 id="wq1025">环境变量</h3>
<p></p>
<dl>
<dt class="bold">HB_SERVER_SOCKET</dt>
<dd>此环境变量应在此命令执行前进行设置。它必须被设置为拓扑服务客户机用来连接到拓扑服务守护进程的 UNIX 域套接字的位置。此环境变量必须设置为 <span class="pk">/var/ha/soc/hats/server_socket.</span><var class="pv">partition name</var>。
</dd>
<dt class="bold">HA_SYSPAR_NAME</dt>
<dd>如果 HB_SERVER_SOCKET 未设置，那么 HA_SYSPAR_NAME 必须被设置为分区名。
</dd>
</dl>
<a name="wq1026"></a>
<h3 id="wq1026">限制</h3>
<p>此命令只在 HACMP 环境中有效。</p>
<p><span class="italic">只有</span>在“IBM 支持中心”的指导下才能使用此命令。</p>
<a name="wq1027"></a>
<h3 id="wq1027">标准输出</h3>
<p>当指定 <span class="pk">-h</span> <span>标志</span>时，将该命令的用法语句写入标准输出。所有详细信息写入标准输出。</p>
<a name="wq1028"></a>
<h3 id="wq1028">标准错误</h3>
<p>必要时此脚本将错误消息写入标准错误。</p>
<a name="wq1029"></a>
<h3 id="wq1029">示例</h3>
<ol type="1">
<li>要将拓扑服务子系统添加到 SRC 中，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -a</span></pre></li>
<li>要启动拓扑服务子系统，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -s</span></pre></li>
<li>要停止拓扑服务子系统，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -k</span></pre></li>
<li>要从 SRC 中删除拓扑服务子系统，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -d</span></pre></li>
<li>要清除拓扑服务子系统，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -c</span></pre></li>
<li>要打开拓扑服务守护进程的跟踪功能，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -t</span></pre></li>
<li>要关闭拓扑服务守护进程的跟踪功能，请输入：
<p></p>
<pre class="xmp"><span class="pk">topsvcsctrl -o</span></pre></li></ol>
<a name="wq1031"></a>
<h3 id="wq1031">位置</h3>
<dl>
<dt class="bold">/usr/sbin/rsct/bin/topsvcsctrl</dt>
<dd>包含 <span class="pk">topsvcsctrl</span> 脚本
</dd>
</dl>
<a name="wq1032"></a>
<h3 id="wq1032">文件</h3>
<dl>
<dt class="bold">/var/ha/log/topsvcs.<var class="pv">cluster_name</var></dt>
<dd>包含名为 <span class="pk">cluster_name</span> 的群集上的 <span class="pk">hatsd</span> 守护进程的记录。
</dd>
</dl>
<a name="wq1033"></a>
<h3 id="wq1033">相关信息</h3>
<p>命令：<a href="http://study.chyangwa.com/IT/AIX/aixcmds5/cmds/aixcmds3/lssrc.htm#a2009166"><span class="pk">lssrc</span></a>、<a href="startsrc.htm#a200945a"><span class="pk">startsrc</span></a>、<a href="stopsrc.htm#a20094a5"><span class="pk">stopsrc</span></a></p>
<p>脚本：<a href="topsvcs.htm#topsvcs"><span class="pk">topsvcs</span></a></p>
<FONT COLOR="#A62A2A"></FONT><p></p>
   <center>
<B>[ <a href="topsvcsctrl.htm#Top_Of_Page">页的顶部</a> | <a href="topsvcs.htm">上一页</a> | <a href="touch.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds502.htm#wq1667">索引</a> | <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>

<a id="Bot_Of_Page" name="Bot_Of_Page"></a>
</body>
</html>
