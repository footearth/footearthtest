<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>命令参考大全，卷 2，d - h - expr 命令</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="dc.date" scheme="iso8601" content="2004-07-29" />
<meta name="copyright" content="(C) IBM公司版权 1997,  2004" />
<meta name="security" content="public" />
<meta name="dc.language" scheme="rfc1766" content="zh-cn" />
<meta name="Robots" content="index,follow"/>
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="owner" content="ctscrcf@cn.ibm.com" />
<meta name="keywords" content="expr 命令, 计算, 表达式, 整数运算式的值" />
<link rel="stylesheet" type="text/css" href="ibmidwb.css" />
<link rel="stylesheet" type="text/css" href="text.css" />
</head>
<body>
<a id="Top_Of_Page" name="Top_Of_Page"></a> <P><center>
<B>[ <a href="expr.htm#Bot_Of_Page">页的底部</a> | <a href="exportvg.htm">上一页</a> | <a href="exptun.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds202.htm#wq1815">索引</a> |  <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>
<center><h1>命令参考大全，卷 2，d - h</h1></center>

<a name="a2059afa"></a>
<h2 id="a2059afa">expr 命令</h2>
<p><a id="idx435" name="idx435"></a> <a id="idx436" name="idx436"></a> <a id="idx437" name="idx437"></a></p>
<a name="ahn9757"></a>
<h3 id="ahn9757">用途</h3>
<a name="f01e1c5304mela"></a>
<p id="f01e1c5304mela">求表达式变量的值。</p>
<a name="ahn9759"></a>
<h3 id="ahn9759">语法</h3>
<p><span class="bold">expr</span><span class="italic"> Expression</span></p>
<a name="ahn9760"></a>
<h3 id="ahn9760">描述</h3>
<a name="f01e1c5723mela"></a>
<p id="f01e1c5723mela"><span class="bold">expr</span> 命令读入 <span class="italic"> Expression</span> 参数，计算它的值，然后将结果写入到标准输出。</p>
<a name="f01e1c5818mela"></a>
<p id="f01e1c5818mela">您必须对 <span class="italic">Expression</span> 参数应用下列规则：</p>
<ul>
<li><a name="c1b6c55643sall"></a><span id="c1b6c55643sall" class="pk"></span>用空格隔开每个项。</li>
<li><a name="c1b6c55721sall"></a><span id="c1b6c55721sall" class="pk"></span>用 \ (反斜杠) 放在 shell 特定的字符前面。</li>
<li><a name="c1b6c55798sall"></a><span id="c1b6c55798sall" class="pk"></span>对包含空格和其他特殊字符的字符串要用引号括起来。</li></ul>
<a name="f01e1c6124mela"></a>
<p id="f01e1c6124mela">整数前面可以放一个一元连字符。在内部，整数被当作 32 位，双互补数。</p>
<p></p><blockquote><a name="c1b6c55955sall"></a><span id="c1b6c55955sall" class="pk"></span><span class="bold">注意：</span><span class="bold">expr</span>命令返回一个 0 来指示一个零值，而不是空字符串。</blockquote>
<a name="f01e1c6290mela"></a>
<p id="f01e1c6290mela">下列项描述了 <span class="italic">Expression</span> 参数的运算符和关键字。需要转义的字符由一个 \ (反斜杠) 放在前面。这些项按照优先权递增的顺序列出，具有相等的优先权的运算符分组在 {} (大括号) 中：</p>
<a name="wq979"></a>
<table id="wq979" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="50%">
<a id="ahn9762" name="ahn9762"></a><span class="italic">Expression1</span><span class="bold"> \|</span><span class="italic"> Expression2</span></td>
<td width="50%">  返回 <span class="italic">Expression1</span>如果它不是空值或者 0 值的话，否则返回 <span class="italic">Expression2</span>。</td>
</tr>
<tr>
<td>
<a id="ahn9763" name="ahn9763"></a><span class="italic">Expression1</span><span class="bold"> \&amp;</span><span class="italic"> Expression2</span></td>
<td>  返回 <span class="italic">Expression1</span>如果两个表达式都不是空值或者 0 值，否则返回一个 0 值。</td>
</tr>
<tr>
<td>
<a id="ahn9764" name="ahn9764"></a><span class="italic">Expression1</span><span class="bold"> { =, \&gt;, \&gt;=, \&lt;, \&lt;=, != }</span><span class="italic"> Expression2</span></td>
<td>如果两个表达式都是整数，返回整数比较的结果；否则它返回的是字符串比较的结果。</td>
</tr>
<tr>
<td>
<a id="ahn9765" name="ahn9765"></a><span class="italic">Expression1</span><span class="bold"> {+, - }</span><span class="italic"> Expression2</span><span class="bold"></span></td>
<td>整数值变量的加或者减。</td>
</tr>
<tr>
<td>
<a id="a2059b05" name="a2059b05"></a><span class="italic">Expression1</span><span class="bold"> { \*, /, % }</span><span class="italic"> Expression2</span></td>
<td>整数值变量的乘、除或者提供除法的余数。</td>
</tr>
<tr>
<td>
<a id="a2059b06" name="a2059b06"></a><span class="italic">Expression1</span><span class="bold"> :</span><span class="italic"> Expression2</span><span class="bold"></span></td>
<td>将 <span class="italic">Expression1</span> 的运算得到的字符串与 <span class="italic">Expression2</span> 的运算结果的正则表达式模式进行比较。正则表达式语法与 <span class="bold">ed</span> 命令相同，除了所有的模式固定到字符串的开始之外（也就是说，只有以字符串的第一个字符开始的序列才被正则表达式匹配）。因此 ^ (插入符号) 在这种情况下就不是特殊字符。
<a name="d7657d5271jani"></a>
<p id="d7657d5271jani">一般地，匹配运算符返回匹配的字符个数（失败的时候返回 0）。如果模式包含了一个子表达式，也就是：</p> 
<p></p>
<a name="d7657d5305jani"></a>
<pre id="d7657d5305jani" class="xmp">\(&nbsp;Expression \)</pre> 
<a name="a39ca581114janb"></a>
<p id="a39ca581114janb">，那么会返回包含了实际匹配的字符的字符串。</p> 
<a name="a39ca581140janb"></a>
<p id="a39ca581140janb">整理序列可以定义在字符范围内使用的等价类。有关整理序列和等价类的更多的信息，请参阅 <span class="italic">AIX 5L Version 5.2 System Management Concepts: Operating System and Devices</span> 中的 <a href="http://study.chyangwa.com/IT/AIX/aixcmds2/aixprggd/nlsgdrf/locale_env.htm#a131c11b">“Understanding Locale Environment Variables”</a>。</p></td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p></p><blockquote><a name="f39026b674mart"></a><span id="f39026b674mart" class="pk"></span><span class="bold">注意：</span> 下列字符串变量会超过标准，其行为可能在不同的操作系统中会有不同。这些字符串变量是“不”可移植的。</blockquote>
<a name="wq980"></a>
<table id="wq980" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="60%">
<a id="f39026b770mart" name="f39026b770mart"></a><span class="bold">match</span><span class="italic">  String1</span><span class="italic"> String2</span></td>
<td width="40%">  与 <span class="italic">Expression1</span><span class="bold"> :</span><span class="italic"> Expression2</span> 相同。</td>
</tr>
<tr>
<td>
<a id="f39026b867mart" name="f39026b867mart"></a><span class="bold">length</span><span class="italic"> String1</span></td>
<td>  返回 <span class="italic">String1</span> 的长度。</td>
</tr>
<tr>
<td>
<a id="f39026b964mart" name="f39026b964mart"></a><span class="bold">index</span><span class="italic"> String1</span><span class="italic"> String2</span></td>
<td>  返回 <span class="italic">String1</span> 中包含 <span class="italic">String2</span> 中任意字符的第一个位置。</td>
</tr>
<tr>
<td colspan="2">
<a id="f39026c063mart" name="f39026c063mart"></a><span class="bold">substr</span><span class="italic"> String1</span><span class="italic"> StartPosition</span><span class="italic"> Length</span></td>
</tr>
<tr>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td>  返回一个以 <span class="italic">StartPosition</span> 的字符开始的在 <span class="italic">String1</span> 中的字符串，并且是 <span class="italic">Length</span> 长度的字符串。</td>
</tr>
</tbody>
</table>
<a name="a349f9178"></a>
<h3 id="a349f9178">退出状态</h3>
<a name="f01e1c7228mela"></a>
<p id="f01e1c7228mela">此命令返回下列出口值:</p>
<a name="wq981"></a>
<table id="wq981" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="5%">
<a id="a2059b0e" name="a2059b0e"></a><span class="bold">0</span></td>
<td width="95%">  <span class="italic">Expression</span> 参数运算值既不为空也不为 0。</td>
</tr>
<tr>
<td>
<a id="a2059b0f" name="a2059b0f"></a><span class="bold">1</span></td>
<td>  <span class="italic">Expression</span> 参数的计算值或者为空或者为 0。</td>
</tr>
<tr>
<td>
<a id="a2059b10" name="a2059b10"></a><span class="bold">2</span></td>
<td>  <span class="italic">Expression</span> 参数是不合法的。</td>
</tr>
<tr>
<td>
<a id="c1b6c57103sall" name="c1b6c57103sall"></a><span class="bold">&gt;2</span></td>
<td>  发生错误。</td>
</tr>
</tbody>
</table>
<p></p><blockquote><a name="a2059b11"></a><span id="a2059b11" class="pk"></span><span class="bold">注意：</span>在 shell 处理完参数后，<span class="bold">expr</span> 命令除了利用数值外不能区分运算符和操作数。因此，如果 <tt>$a</tt> 的值是 <tt>j</tt> 的话,命令：</blockquote>
<p></p>
<a name="a2059b12"></a>
<pre id="a2059b12" class="xmp">expr $a = j</pre>
<a name="a2059b13"></a>
<p id="a2059b13">就像：</p>
<p></p>
<a name="a2059b14"></a>
<pre id="a2059b14" class="xmp">expr j = j</pre>
<a name="a2059b15"></a>
<p id="a2059b15">在 shell 将所有的参数都传给 <span class="bold">expr</span> 命令之后。下列情况也为真：</p>
<p></p>
<a name="a2059b16"></a>
<pre id="a2059b16" class="xmp">expr X$a = Xj</pre>
<a name="a2059b17"></a>
<h3 id="a2059b17">示例</h3>
<ol type="1">
<li><a name="a2059b18"></a><span id="a2059b18" class="pk"></span>要修改一个 shell 变量，请输入：
<p></p>
<a name="a2059b19"></a>
<pre id="a2059b19" class="xmp">COUNT=`expr $COUNT + 1`</pre><p class="indatacontent"> 这会加 <tt>1</tt> 到 shell 变量 <tt>$COUNT</tt> 上。<span class="bold"> expr</span> 命令以 grave accent 包装，这会导致 shell 将 <span class="bold">expr</span> 命令的标准输出替换到 <tt>COUNT=</tt> 命令的标准输出。<tt>$COUNT</tt> 变量使用前必须初始化。</p></li>
<li><a name="a2059b1b"></a><span id="a2059b1b" class="pk"></span>要想得到 <span class="bold">$STR</span> shell 变量的长度，请输入：
<p></p>
<a name="a2059b1c"></a>
<pre id="a2059b1c" class="xmp">LENGTH=`expr $STR : ".*"`</pre><p class="indatacontent"> 这会将 <tt>LENGTH</tt> 变量设置成由 ：（冒号）运算符给出的值。.*（点，星号）模式会对任何字符串从头到尾去匹配，因此冒号运算符给出 <tt>$STR</tt> 变量的长度作为匹配字符的数目。注意，<tt>.*</tt> 必须在引号内，来防止 shell 将 *（星号）处理成模式匹配字符。引号不是模式中的一部分。</p> 
<a name="f01e1c8461mela"></a>
<p id="f01e1c8461mela">如果 <tt>$STR</tt> 变量设置成空字符串或者包含了任何空格（空白或者制表键）的话，那么该命令会显示错误信息 <tt>expr: syntax error</tt>。这是因为 shell 通常不会将空字符串传递给命令。在这种情况下，<span class="bold">expr</span> 命令只能看见：</p> 
<p></p>
<a name="a2059b1f"></a>
<pre id="a2059b1f" class="xmp">:.*</pre><p class="indatacontent"> shell 还会除去单个的引号。不起作用的原因是因为冒号运算符要求有两个值。这个问题可以通过将 shell 变量以双引号括起来解决：</p>
<a name="a2059b21"></a>
<pre id="a2059b21" class="xmp">LENGTH=`expr "$STR" : ".*"`</pre><p class="indatacontent"> 现在，如果 <tt>$STR</tt> 变量的值为空的话，<tt>LENGTH</tt> 变量被设置成 0 值。通常我们推荐将 shell 变量用双引号括起来。不要将 shell 变量用单引号标记括起来。</p></li>
<li><a name="a2059b23"></a><span id="a2059b23" class="pk"></span>要想使用一个字符串的一部分，请输入：
<p></p>
<a name="a2059b24"></a>
<pre id="a2059b24" class="xmp">FLAG=`expr "$FLAG" : "-*\(.*\)"`</pre><p class="indatacontent"> 只要 <tt>$FLAG</tt> shell 变量前面有连字符，就会除去连字符。冒号运算符给出 <tt>FLAG</tt> 变量的一部分，该变量由在 \(&nbsp;和 \) 字符（反斜杠，开括号和反斜杠，闭括号）中间的子表达式匹配。如果您忽略 \(&nbsp;和&nbsp;\) 子表达式字符的话，冒号运算符会给出匹配的字符数目。</p> 
<a name="f01e1c9180mela"></a>
<p id="f01e1c9180mela">如果 <tt>$FLAG</tt> 变量设置成 - (连字符), 则该命令会显示一个语法错误消息。这是因为 shell 会将 <tt>$FLAG</tt> 变量的值替换，在运行 <span class="bold">expr</span> 命令之前。<span class="bold">expr</span> 命令不知道连字符是一个变量的值。它只能理解：</p> 
<p></p>
<a name="a2059b27"></a>
<pre id="a2059b27" class="xmp">- : -*\(.*\)</pre><p class="indatacontent"> 并且它会将第一个连字符解释成减号运算符。要消除这种问题，请使用：</p>
<a name="a2059b29"></a>
<pre id="a2059b29" class="xmp">FLAG=`expr "x$FLAG" : "x-*\(.*\)"`</pre></li>
<li><a name="a2059b2a"></a><span id="a2059b2a" class="pk"></span>要想使用 <span class="bold">expr</span> 命令在 <span class="bold">if</span> 语句中，请输入：
<p></p>
<a name="a2059b2b"></a>
<pre id="a2059b2b" class="xmp">if expr "$ANSWER" : "[yY]" &gt;/dev/null
则返回 ANSWER 以 "y" 或者 "Y" 开始 fi</pre><p class="indatacontent"> 如果 <tt>$ANSWER</tt> 变量以 <tt>y</tt> 或者 <tt>Y</tt> 开始的话，<span class="bold">if</span> 语句的<tt>then</tt> 部分会执行。如果匹配成功表达式的结果为 1，并且 <span class="bold"> expr</span> 命令会返回一个为 0 的出口值，这个出口值被 <span class="bold">if</span> 语句识别成逻辑值真。如果匹配失败，结果为 0，出口值为 1。</p> 
<a name="f01e1c9710mela"></a>
<p id="f01e1c9710mela">将 <span class="bold">expr</span> 命令的标准输出重新定向到 <span class="bold"> /dev/null</span> 特殊文件，而废弃该表达式的结果。如果您没有对它重新定向，结果就会写到标准输出中，通常是您的工作站显示器。</p></li>
<li><a name="a2059b2e"></a><span id="a2059b2e" class="pk"></span>考虑下列表达式：
<p></p>
<a name="a2059b2f"></a>
<pre id="a2059b2f" class="xmp">expr "$STR" = "="</pre><p class="indatacontent"> 如果 <tt>$STR</tt> 变量有值为  <tt>=</tt>（等号），那么在 shell 处理完这个命令之后，<span class="bold">expr</span>命令会看到表达式：</p>
<a name="a2059b31"></a>
<pre id="a2059b31" class="xmp">= = =</pre><p class="indatacontent"> <span class="bold">expr</span> 命令将这个解释成在一行中的三个等号运算符，并显示一个语法出错消息。一旦 shell 变量的值与 <span class="bold"> expr</span> 运算符中的一个相同，这种情况就会发生。避免这种问题的方法是，将该表达式写成：</p>
<a name="a2059b33"></a>
<pre id="a2059b33" class="xmp">expr "x$STR" = "x="</pre></li>
<li><a name="f39026f312mart"></a><span id="f39026f312mart" class="pk"></span>要想返回 $SHELL 环境变量 /usr/bin/ksh 的长度，请输入：
<p></p>
<a name="f39026f399mart"></a>
<pre id="f39026f399mart" class="xmp">expr length $SHELL</pre><p class="indatacontent"> 显示如下：</p>
<a name="f39026f572mart"></a>
<pre id="f39026f572mart" class="xmp">12</pre></li>
<li><a name="f39026f670mart"></a><span id="f39026f670mart" class="pk"></span>要想返回 "de" 字符串中的任何一个字符在 "abcdef" 中出现的第一个位置，请输入：
<p></p>
<a name="f39026f757mart"></a>
<pre id="f39026f757mart" class="xmp">expr index abcdef de</pre><p class="indatacontent"> 显示如下：T</p>
<a name="f39026f930mart"></a>
<pre id="f39026f930mart" class="xmp">4</pre></li>
<li><a name="f390270029mart"></a><span id="f390270029mart" class="pk"></span>要想返回 "fd" 字符串的任何字符在  "abcdef" 中出现的第一个位置，请输入：
<p></p>
<a name="f390270119mart"></a>
<pre id="f390270119mart" class="xmp">expr index abcdef fd</pre><p class="indatacontent"> 显示如下：</p>
<a name="f390270291mart"></a>
<pre id="f390270291mart" class="xmp">4</pre></li>
<li><a name="f390270386mart"></a><span id="f390270386mart" class="pk"></span>要想返回 "Goodnight Ladies" 字符串中从位置11开始的6个字符长的字符串，请输入：
<p></p>
<a name="f390270479mart"></a>
<pre id="f390270479mart" class="xmp">expr substr "Goodnight Ladies" 11 6</pre><p class="indatacontent"> 显示如下：</p>
<a name="f390270652mart"></a>
<pre id="f390270652mart" class="xmp">Ladies</pre></li></ol>
<a name="a349f9179"></a>
<h3 id="a349f9179">文件</h3>
<p></p>
<a name="wq983"></a>
<table id="wq983" width="100%" summary="" border="0" frame="void" rules="none">
<tbody valign="top">
<tr>
<td width="21%">
<a id="ljch200" name="ljch200"></a><span class="bold">/usr/bin/expr</span></td>
<td width="78%">  包含了 <span class="bold">expr</span> 命令。</td>
</tr>
</tbody>
</table>
<a name="a2059b34"></a>
<h3 id="a2059b34">相关信息</h3>
<a name="f01e1ca818mela"></a>
<p id="f01e1ca818mela"><a href="http://study.chyangwa.com/IT/AIX/aixcmds2/cmds/aixcmds1/bsh.htm#a27991201"><span class="bold">bsh</span></a> 命令，<a href="http://study.chyangwa.com/IT/AIX/aixcmds2/cmds/aixcmds1/csh.htm#a27991075"><span class="bold">csh</span></a> 命令，<a href="ed.htm#a133z9c66"><span class="bold">ed</span></a> 命令，<a href="http://study.chyangwa.com/IT/AIX/aixcmds2/cmds/aixcmds3/ksh.htm#a265912f6"><span class="bold">ksh</span></a> 命令。</p>
<a name="f01e1ca910mela"></a>
<p id="f01e1ca910mela"><span class="italic">《AIX 5L V5.2 系统用户指南：操作系统与设备》</span>中的<a href="http://study.chyangwa.com/IT/AIX/aixcmds2/aixuser/usrosdev/cmds_overview.htm#i8n310wmh3">『命令概述』</a>。</p>
<a name="f01e1cb004mela"></a>
<p id="f01e1cb004mela"><span class="italic">AIX 5L Version 5.2 National Language Support Guide and Reference</span> 中的 <a href="http://study.chyangwa.com/IT/AIX/aixcmds2/aixprggd/nlsgdrf/nat_lang_support.htm">National Language Support Overview</a>。</p>
<FONT COLOR="#A62A2A"></FONT><p></p>
   <center>
<B>[ <a href="expr.htm#Top_Of_Page">页的顶部</a> | <a href="exportvg.htm">上一页</a> | <a href="exptun.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds202.htm#wq1815">索引</a> | <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>

<a id="Bot_Of_Page" name="Bot_Of_Page"></a>
</body>
</html>
