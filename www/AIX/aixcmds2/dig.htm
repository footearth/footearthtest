<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>命令参考大全，卷 2，d - h - dig 命令</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="dc.date" scheme="iso8601" content="2004-07-29" />
<meta name="copyright" content="(C) IBM公司版权 1997,  2004" />
<meta name="security" content="public" />
<meta name="dc.language" scheme="rfc1766" content="zh-cn" />
<meta name="Robots" content="index,follow"/>
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="owner" content="ctscrcf@cn.ibm.com" />
<meta name="keywords" content="dig" />
<link rel="stylesheet" type="text/css" href="ibmidwb.css" />
<link rel="stylesheet" type="text/css" href="text.css" />
</head>
<body>
<a id="Top_Of_Page" name="Top_Of_Page"></a> <P><center>
<B>[ <a href="dig.htm#Bot_Of_Page">页的底部</a> | <a href="diffmk.htm">上一页</a> | <a href="digest.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds202.htm#wq1815">索引</a> |  <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>
<center><h1>命令参考大全，卷 2，d - h</h1></center>
<a id="idx203" name="idx203"></a>
<a name="dig"></a>
<h2 id="dig">dig 命令</h2>
<a name="wq321"></a>
<h3 id="wq321">用途</h3>
<p>DNS 查询实用程序。</p>
<a name="wq322"></a>
<h3 id="wq322">语法</h3>
<p><span class="bold">dig</span> [<span class="italic">@server</span>]
[<a href="dig.htm#dig_flags_b"><span class="bold">-b</span></a> <span class="italic">address</span>] [<a href="dig.htm#dig_flags_c"><span class="bold">-c</span></a> <span class="italic">class</span>] [<a href="dig.htm#dig_flags_f"><span class="bold">-f</span></a> <span class="italic">filename</span>] [<a href="dig.htm#dig_flags_k"><span class="bold">-k</span></a> <span class="italic">filename</span>] [ <a href="dig.htm#dig_flags_n"><span class="bold">-n</span></a> ][<a href="dig.htm#dig_flags_p"><span class="bold">-p</span></a> <span class="italic">port#</span>] [<a href="dig.htm#dig_flags_t"><span class="bold">-t</span></a> <span class="italic">type</span>] [<a href="dig.htm#dig_flags_x"><span class="bold">-x</span></a> <span class="italic">addr</span>] [<a href="dig.htm#dig_flags_y"><span class="bold">-y</span></a> <span class="italic">name:key</span>] [<span class="italic">name</span>] [<span class="italic">type</span>]
[<span class="italic">class</span>] [<span class="italic">queryopt...</span>]</p>
<p><span class="bold">dig</span> [<a href="dig.htm#dig_flags_h"><span class="bold">-h</span></a>]</p>
<p><span class="bold">dig</span> [<span class="italic">global-queryopt...</span>]
[<span class="italic">query...</span>]</p>
<a name="wq323"></a>
<h3 id="wq323">描述</h3>
<p><span class="bold">dig</span>（域信息搜索器）命令是一个用于询问 DNS 域名服务器的灵活的工具。它执行 DNS 搜索，显示从受请求的域名服务器返回的答复。多数
 DNS 管理员利用 <span class="bold">dig</span> 作为 DNS 问题的故障诊断，因为它灵活性好、易用、输出清晰。虽然通常情况下 <span class="bold">dig</span> 使用命令行参数，但它也可以按批处理模式从文件读取搜索请求。不同于早期版本，<span class="bold">dig</span> 的 BIND9 实现允许从命令行发出多个查询。除非被告知请求特定域名服务器，<span class="bold">dig</span> 将尝试 <span class="bold">/etc/resolv.conf</span> 中列举的所有服务器。当未指定任何命令行参数或选项时，<span class="bold">dig</span> 将对“<span class="bold">.</span>”（根）执行 NS 查询。</p>
<a name="wq324"></a>
<h3 id="wq324">标志</h3>
<p></p>
<a name="wq325"></a>
<table id="wq325" width="100%" summary="" border="0" frame="void" rules="all">
<tbody valign="top">
<tr>
<td width="13%">
<a id="dig_flags_b" name="dig_flags_b"></a><span class="bold">-b</span> <span class="italic">address</span></td>
<td width="86%">设置所要询问地址的源 IP 地址。这必须是主机网络接口上的某一合法的地址。</td>
</tr>
<tr>
<td>
<a id="dig_flags_c" name="dig_flags_c"></a><span class="bold">-c</span> <span class="italic">class</span></td>
<td>缺省查询类（IN for internet）由选项 <span class="bold">-c</span> 重设。<span class="bold-italic">class</span> 可以是任何合法类，比如查询 Hesiod 记录的 HS 类或查询 CHAOSNET 记录的 CH 类。</td>
</tr>
<tr>
<td>
<a id="dig_flags_f" name="dig_flags_f"></a><span class="bold">-f</span> <span class="italic">filename</span></td>
<td>使 <span class="bold">dig</span> 在批处理模式下运行，通过从文件 <span class="bold-italic">filename</span> 读取一系列搜索请求加以处理。文件包含许多查询；每行一个。文件中的每一项都应该以和使用命令行接口对 <span class="bold">dig</span> 的查询相同的方法来组织。</td>
</tr>
<tr>
<td>
<a id="dig_flags_h" name="dig_flags_h"></a><span class="bold">-h</span></td>
<td>当使用选项 <span class="bold">-h</span> 时，显示一个简短的命令行参数和选项摘要。</td>
</tr>
<tr>
<td>
<a id="dig_flags_k" name="dig_flags_k"></a><span class="bold">-k</span> <span class="italic">filename</span></td>
<td>要签署由 <span class="bold">dig</span> 发送的 DNS 查询以及对它们使用事务签名（TSIG）的响应，用
选项 <span class="bold">-k</span> 指定 TSIG 密钥文件。</td>
</tr>
<tr>
<td>
<a id="dig_flags_n" name="dig_flags_n"></a><span class="bold">-n</span></td>
<td>缺省情况下，使用 IP6.ARPA 域和 RFC2874 定义的二进制标号搜索 IPv6 地址。为了使用更早的、
使用 IP6.INT 域和 <span class="bold">nibble</span> 标签的 RFC1886 方法，指定
选项 <span class="bold">-n</span>（nibble）。</td>
</tr>
<tr>
<td>
<a id="dig_flags_p" name="dig_flags_p"></a><span class="bold">-p</span> <span class="italic">port#</span></td>
<td>如果需要查询一个非标准的端口号，则使用选项 <span class="bold">-p</span>。port# 是 dig 将发送其查询的端口号，而不是标准的 DNS 端口号 53。该选项可用于测试已在非标准端口号上配置成侦听查询的域名服务器。</td>
</tr>
<tr>
<td>
<a id="dig_flags_t" name="dig_flags_t"></a><span class="bold">-t</span> <span class="italic">type</span></td>
<td>设置查询类型为 <span class="bold-italic">type</span>。可以是 BIND9 支持的任意有效查询类型。缺省查询类型是 <span class="bold">A</span>，除非提供 <span class="bold">-x</span> 选项来指示一个逆向查询。通过指定 AXFR 的
 <span class="bold-italic">type</span> 可以请求一个区域传输。当需要增量区域传输（IXFR）时，<span class="bold-italic">type</span> 设置为
 <span class="bold">ixfr=N</span>。增量区域传输将包含自从区域的 SOA 记录中的序列号改为
 <span class="bold">N</span> 之后对区域所做的更改。</td>
</tr>
<tr>
<td>
<a id="dig_flags_x" name="dig_flags_x"></a><span class="bold">-x</span> <span class="italic">addr</span></td>
<td>逆向查询（将地址映射到名称）可以通过 <span class="bold">-x</span> 选项加以简化。<span class="bold-italic">addr</span> 是一个
以小数点为界的 IPv4 地址或冒号为界的 IPv6 地址。当使用这个选项时，无需提供 <span class="italic">name</span>、<span class="italic">class</span> 和 <span class="italic">type</span> 参数。<span class="bold">dig</span> 自动运行类似  <tt class="xph">11.12.13.10.in-addr.arpa</tt> 的域名查询，并分别设置查询类型和类为 PTR 和 IN。</td>
</tr>
<tr>
<td>
<a id="dig_flags_y" name="dig_flags_y"></a><span class="bold">-y</span> <span class="italic">name:key</span></td>
<td>您可以通过命令行上的 <span class="bold">-y</span> 选项指定 TSIG 密钥；<span class="bold-italic">name</span> 是 TSIG 密码的名称，<span class="bold-italic">key</span> 是实际的密码。密码是 64 位加密字符串，通常由 <span class="bold">dnssec-keygen</span>（8）生成。当在多用户系统上使用选项 <span class="bold">-y</span> 时应该谨慎，因为密码在 ps（1）的输出或 shell 的历史文件中可能是可见的。当同时使用 <span class="bold">dig</span> 和 TSCG 认证时，被查询的名称服务器需要知道密码和解码规则。在 BIND 中，通过提供正确的密码和 <span class="bold">named.conf</span> 中的服务器声明实现。</td>
</tr>
</tbody>
</table>
<a name="wq326"></a>
<h3 id="wq326">参数</h3>
<a name="wq327"></a>
<table id="wq327" width="100%" summary="" border="0" frame="void" rules="all">
<tbody valign="top">
<tr>
<td width="13%"><span class="bold"><var class="pv">global-queryopt...</var></span></td>
<td width="86%">全局查询选项（请参阅<a href="dig.htm#globalqueryoptionjan">多个查询</a>）。</td>
</tr>
<tr>
<td><span class="bold"><var class="pv">查询</var></span></td>
<td>查询选项（请参阅<a href="dig.htm#queryoptionjan">查询选项</a>）。</td>
</tr>
</tbody>
</table>
<a name="queryoptionjan"></a>
<h3 id="queryoptionjan">查询选项</h3>
<p><span class="bold">dig</span> 提供查询选项号，它影响搜索方式和结果显示。一些在查询请求报头设置或复位标志位，一部分决定显示哪些回复信息，其它的确定超时和重试战略。每个查询选项被带前缀（+）的关键字标识。一些关键字设置或复位一个选项。通常前缀是求反关键字含义的字符串 no。其他关键字分配各选项的值，比如超时时间间隔。它们的格式形如 <span class="bold"><tt class="xph">+keyword=value</tt></span>。查询选项是：</p>
<dl>
<dt class="bold">+[no]tcp</dt>
<dd>查询域名服务器时使用 [不使用] TCP。缺省行为是使用 UDP，除非是 AXFR 或 IXFR 请求，才使用 TCP 连接。
</dd>
<dt class="bold">+[no]vc</dt>
<dd>查询名称服务器时使用 [不使用] TCP。<span class="bold"><tt class="xph">+[no]tcp</tt></span> 的备用语法提供了向下兼容。
<span class="bold">vc</span> 代表虚电路。
</dd>
<dt class="bold">+[no]ignore</dt>
<dd>忽略 UDP 响应的中断，而不是用 TCP 重试。缺省情况运行 TCP 重试。
</dd>
<dt class="bold">+domain=somename</dt>
<dd>设定包含单个域  <span class="bold-italic">somename</span> 的搜索列表，好像被 <span class="bold">/etc/resolv.conf</span> 中的域伪指令指定，并且启用搜索列表处理，好像给定了 <span class="bold"><tt class="xph">+search</tt></span> 选项。
</dd>
<dt class="bold">+[no]search</dt>
<dd>使用 [不使用] 搜索列表
或 <span class="bold">resolv.conf</span> 中的域伪指令（如果有的话）定义的搜索列表。缺省情况不使用搜索列表。
</dd>
<dt class="bold">+[no]defname</dt>
<dd>不建议看作 <span class="bold"><tt class="xph">+[no]search</tt></span> 的同义词。
</dd>
<dt class="bold">+[no]aaonly</dt>
<dd>该选项不做任何事。它用来提供对设置成未实现解析器标志的 <span class="bold">dig</span> 的旧版本的兼容性。
</dd>
<dt class="bold">+[no]adflag</dt>
<dd>在查询中设置 [不设置] AD（真实数据）位。目前 AD 位只在响应中有标准含义，而查询中没有，但是出于完整性考虑在查询中这种性能可以设置。
</dd>
<dt class="bold">+[no]cdflag</dt>
<dd>在查询中设置 [不设置] CD（检查禁用）位。它请求服务器不运行响应信息的 DNSSEC 合法性。
</dd>
<dt class="bold">+[no]recursive</dt>
<dd>切换查询中的 RD（要求递归）位设置。在缺省情况下设置该位，也就是说 dig 正常情形下发送递归查询。当使用
查询选项 <span class="bold"><tt class="xph">+nssearch</tt></span> 或 <span class="bold"><tt class="xph">+trace</tt></span> 时，递归自动禁用。
</dd>
<dt class="bold">+[no]nssearch</dt>
<dd>这个选项被设置时，<span class="bold">dig</span> 试图寻找包含待搜名称的网段的权威域名服务器，并显示网段中每台域名服务器的 SOA 记录。
</dd>
<dt class="bold">+[no]trace</dt>
<dd>切换为待查询名称从根名称服务器开始的代理路径跟踪。缺省情况不使用跟踪。一旦启用跟踪，<span class="bold">dig</span> 使用迭代查询解析待查询名称。它将按照从根服务器的参照，显示来自每台使用解析查询的服务器的应答。
</dd>
<dt class="bold">+[no]cmd</dt>
<dd>设定在输出中显示指出 <span class="bold">dig</span> 版本及其所用的查询选项的初始注释。缺省情况下显示注释。
</dd>
<dt class="bold">+[no]short</dt>
<dd>提供简要答复。缺省值是以冗长格式显示答复信息。
</dd>
<dt class="bold">+[no]identify</dt>
<dd>当启用 <span class="bold"><tt class="xph">+short</tt></span> 选项时，显示 [或不显示] 提供应答的 IP 地址和端口号。如果请求简短格式应答，缺省情况不显示提供应答的服务器的源地址和端口号。
</dd>
<dt class="bold">+[no]comments</dt>
<dd>切换输出中的注释行显示。缺省值是显示注释。
</dd>
<dt class="bold">+[no]stats</dt>
<dd>该查询选项设定显示统计信息：查询进行时，应答的大小等等。缺省显示查询统计信息。
</dd>
<dt class="bold">+[no]qr</dt>
<dd>显示 [不显示] 发送的查询请求。缺省不显示。
</dd>
<dt class="bold">+[no]question</dt>
<dd>当返回应答时，显示 [不显示] 查询请求的问题部分。缺省作为注释显示问题部分。
</dd>
<dt class="bold">+[no]answer</dt>
<dd>显示 [不显示] 应答的回答部分。缺省显示。
</dd>
<dt class="bold">+[no]authority</dt>
<dd>显示 [不显示] 应答的权限部分。缺省显示。
</dd>
<dt class="bold">+[no]additional</dt>
<dd>显示 [不显示] 应答的附加部分。缺省显示。
</dd>
<dt class="bold">+[no]all</dt>
<dd>设置或清除所有显示标志。
</dd>
<dt class="bold">+time=T</dt>
<dd>为查询设置超时时间为 <span class="bold-italic">T</span> 秒。缺省是5秒。如果将 <span class="bold-italic">T</span> 设置为小于1的数，则以1秒作为查询超时时间。
</dd>
<dt class="bold">+tries=A</dt>
<dd>设置向服务器发送 UDP 查询请求的重试次数为 <span class="bold-italic">A</span>，代替缺省的 3 次。如果把 <span class="bold-italic">A</span> 小于或等于 0，则采用 1 为重试次数。
</dd>
<dt class="bold">+ndots=D</dt>
<dd>出于完全考虑，设置必须出现在名称 <span class="bold-italic">D</span> 的点数。缺省值是使用在 <span class="bold">/etc/resolv.conf</span> 中的 <span class="bold">ndots</span> 语句定义的，或者是 1，如果没有 <span class="bold">ndots</span> 语句的话。带更少点数的名称
被解释为相对名称，并通过搜索列表中的域或文件  <span class="bold">/etc/resolv.conf</span> 中的域伪指令进行搜索。
</dd>
<dt class="bold">+bufsize=B</dt>
<dd>设置使用 EDNS0 的 UDP 消息缓冲区大小为 <span class="bold-italic">B</span> 字节。缓冲区的最大值和最小值分别为 65535 和 0。超出这个范围的值自动舍入到最近的有效值。
</dd>
<dt class="bold">+[no]multiline</dt>
<dd>以详细的多行格式显示类似 SOA 的记录，并附带可读注释。缺省值是每单个行上显示一条记录，以便于计算机解析 <span class="bold">dig</span> 的输出。
</dd>
</dl>
<a name="wq328"></a>
<h3 id="wq328">多条查询</h3>
<p><span class="bold">dig</span> 的 BIND9 支持在命令行上指定多个查询（支持 <span class="bold">-f</span> 批处理文件选项的附加功能）。每条查询可以使用自己的标志位、选项和查询选项。</p>
<p>在这种情况下，在上面描述的命令行语法中，每条查询自变量代表一个个别查询。每一条由任意标准选项和标志、待查询名称、可选查询类型和类以及任何适用于该查询的查询选项。</p>
<a name="globalqueryoptionjan"></a>
<p id="globalqueryoptionjan">也可以使用对所有查询均有效的查询选项全局集合。全局查询选项必须位于命令行上第一个名称、类、类型、选项、标志和查询选项的元组之前。任何全局查询选项（除了 <span class="bold">+[no]cmd</span> 选项）可以被下面的查询特别选项重设。例如:
</p>
<pre class="xmp">dig +qr www.isc.org any -x 127.0.0.1 isc.org ns +noqr</pre><p class="indatacontent">显示 <span class="bold">dig</span> 如何从命令行出发进行三个查询：一个针对 <span class="bold">www.isc.org</span>的任意查询、一个 127.0.0.1 的逆向查询，以及
一个 <span class="bold">isc.org</span> 的 NS 记录查询。应用了 <span class="bold">+qr</span> 的全局查询选项，以便 <span class="bold">dig</span> 显示进行每条查询的初始查询。最后那个查询有一个本地查询选项
 <span class="bold">+noqr</span>，表示 <span class="bold">dig</span> 在搜索 <span class="bold">isc.org</span> 的 NS 记录时不显示初始查询。</p>
<a name="wq329"></a>
<h3 id="wq329">示例</h3>
<p>一个典型的 <span class="bold">dig</span> 调用类似：</p>
<pre class="xmp">dig @<span class="italic">server</span> <span class="italic">name</span> <span class="italic">type</span></pre><p class="indatacontent">  其中：</p>
<dl>
<dt class="bold"><span class="italic">server</span></dt>
<dd>待查询名称服务器的名称或 IP 地址。可以是用点分隔的 IPv4 地址或用冒号分隔的 IPv6 地址。当由主机提供服务器参数时，<span class="bold">dig</span> 在查询域名服务器前先解析那个名称。如果没有服务器参数可以提供，<span class="bold">dig</span> 参考 <span class="bold">/etc/resolv.conf</span>，然后查询列举在那里的域名服务器。显示来自域名服务器的应答。
</dd>
<dt class="bold"><span class="italic">name</span></dt>
<dd> 将要查询的资源记录的名称。
</dd>
<dt class="bold"><span class="italic">type</span></dt>
<dd>显示所需的查询类型 － <span class="bold">ANY</span>、<span class="bold">A</span>、<span class="bold">MX</span>、<span class="bold">SIG</span>，以及任何有效查询类型等。如果不提供任何类型参数，<span class="bold">dig</span> 将对纪录 <span class="bold-italic">A</span> 执行查询。
</dd>
</dl>
<a name="wq330"></a>
<h3 id="wq330">文件</h3>
<a name="wq331"></a>
<table id="wq331" width="100%" summary="" border="0" frame="void" rules="all">
<tbody valign="top">
<tr>
<td width="26%"><span class="bold">/etc/resolv.conf</span></td>
<td width="73%"></td>
</tr>
</tbody>
</table>
<a name="wq332"></a>
<h3 id="wq332">相关信息</h3>
<p><a href="host.htm#a072989b">host</a> 和 <a href="dnssec-keygen.htm#dnssec-keygen">dnssec-keygen</a> 命令。</p>
<p>named8 守护进程。</p>
<p>RFC1035</p>
<FONT COLOR="#A62A2A"></FONT><p></p>
   <center>
<B>[ <a href="dig.htm#Top_Of_Page">页的顶部</a> | <a href="diffmk.htm">上一页</a> | <a href="digest.htm">下一页</a> | <a href="mastertoc.htm#mtoc">目录</a> | <a href="aixcmds202.htm#wq1815">索引</a> | <A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>资料库</B></A> |
<A HREF="notices.htm"><B>法律条款</B></A> |
<A HREF="file:///C|/download/www16.boulder.ibm.com/cgi-bin/ds_form@lang=zh_CN&viewset=AIX" TARGET="_top"><B>搜索</B></A> ]</B>
</center>

<a id="Bot_Of_Page" name="Bot_Of_Page"></a>
</body>
</html>
